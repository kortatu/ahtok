{"version":3,"sources":["Utils.ts","tok/Token.ts","tok/TokenSpan.tsx","tok/ParamChanger.tsx","AppActions.ts","tok/SkillTestChanger.tsx","tok/PassZone.tsx","tok/CharacterSelector.tsx","AppState.ts","tok/Scenario.ts","tok/ContextManager.tsx","CommonStyles.ts","tok/TokenBag.tsx","tok/ScenarioPassZone.tsx","TokTheme.ts","tok/AHCharacter.ts","tok/LaEraOlvidada.ts","tok/ElLegadoDeDunwich.ts","tok/LaConspiracionDeInnsmouth.ts","tok/CaminoACarcosa.ts","tok/Campaign.ts","tok/LosDevoradoresDeSuenos.ts","tok/ElCirculoRoto.ts","AppReducers.ts","AppStore.ts","CampaignWizard.tsx","TokHeader.tsx","App.tsx","serviceWorker.ts","I18n.tsx","index.tsx"],"names":["incDecNatural","previous","incDec","Math","max","tokenSpecDef","value","count","chaos","name","actualName","id","uuid","copyTokenSpec","tokenSpec","findName","tokenBagSpec","tokens","find","t","removeToken","tokenName","newBag","map","ts","tokenSpecInBag","filter","addTokens","forEach","push","buildBagSpec","commonTokenEffectSpec","effect","tokenBag","character","elderSignEffect","tokenAverage","seal","incDecContextNatural","state","key","buildEffectSpecs","effectMap","Map","effectSpecs","ns","set","buildBagFromSpec","bagSpec","effects","context","tokenDef","get","FALLO_AUTOMATICO","sortTokens","sort","a","b","tokenFloatAverage","numOfTokens","reduce","sum","token","floor","accumulated","previousValues","last","length","undefined","histogram","prev","curr","prevValue","concat","tokensFiltered","decCount","tokenBagPassZone","accum","total","vc","prob","sorted","i","j","tokensWithValue","passZoneLines","tokenBagMap","skill","test","lines","stillPass","result","pass","nextPass","currentProb","firstFail","TokenSpan","props","useState","fadeIn","setFadeIn","Fade","in","onExited","onClick","style","cursor","className","fadeOut","fadeOutFadeIn","ContextValueChanger","valueSpec","useTranslation","type","NumericParamChanger","inline","currentValue","incValue","incDecContextValue","decValue","BooleanParamChanger","toggle","toggleContextValue","incDecStyle","verticalAlign","InputLabel","IconButton","_","Switch","checked","onChange","color","inputProps","changeSkill","changeTest","CurrentSkillTestChanger","connect","skillTest","dispatch","incSkill","decSkill","incTest","decTest","Typography","variant","CurrentPassZone","ownProps","passZone","Grid","container","alignItems","item","xs","sm","md","direction","line","PassLine","textAlign","lineSeparator","liStyle","borderColor","spacing","toFixed","noWrap","index","useStyles","makeStyles","theme","createStyles","formControl","margin","minWidth","selectEmpty","marginTop","CurrentCharacterSelector","selectedCharacter","characters","selectedCampaign","setCharacter","changeCharacter","FormControl","Select","labelId","shortName","e","target","c","aChar","MenuItem","buildBagFromState","appState","selectedScenario","scenarioEffectSpec","gameContext","initContext","contextSpec","valuesSpec","vs","initialValue","CurrentScenarioContextManager","spec","paddingTop","Object","keys","contextKey","useModalStyles","paper","position","left","top","width","opacity","backgroundColor","palette","background","border","secondary","main","boxShadow","shadows","padding","BagDisplay","showAverage","fadeOutTokens","bag","allTokensIndividually","allTokens","CurrentTokenBagManager","addToken","classes","allKnown","Box","BagSpecDisplay","CurrentScenarioPassZone","scenario","open","setOpen","Modal","onClose","aria-labelledby","Button","tokTheme","baseFontFamily","uglyQuaFontFamily","responsiveFontSizes","createMuiTheme","typography","fontFamily","join","fontSize","tonalOffset","primary","headerFontFamily","headerFontFamilyNonAscii","AHCharacters","JoeDiamond","DianaStanley","LeoAnderson","UrsulaDowns","LolaHayes","LukeRobinson","MandyThompson","TonyMorgan","PatriceHathaway","SisterMary","TrishScarborough","DexterDrake","Malasombra","MarkHarrigan","Sefina","LaPerdicionDeEztli","fichas","translations","description","buildLaEraOlvidadaCampaignSpec","scenarios","min","bagSpecsByLevel","easy","normal","hard","expert","PerdidosEnElTiempoYEnElEspacio","SHROUD","ElPozoDeLaDesesperacion","FLOODED","floodedModifier","ElJuramentoInconfesable","CHOOSE_AN_ENEMY","AHLevels","Campaigns","TheCircleUndone","buildElCirculoRotoCampaignSpec","TheForgottenAge","TheDunwichLegacy","TheDreamEatersA","ceil","TheDreamEatersB","InnsmouthConspiracy","PathToCarcosa","campaignTranslations","values","allTrans","campaign","thisTranslations","lang","scenarioLang","valueSpecLang","Campaign","campaignSpec","currentBagSpec","currentScenario","this","startCampaign","scenarioNum","scenarioIndex","getScenarioSpec","level","EnLasGarrasDelCaos","getPerdicionYBrecha","potentialBag","AnteElTronoNegro","getHalfDoomInAzathot","defaultCampaign","start","addTokensToBagSpec","startAlvaroElCirculoRotoLPDP","firstScenario","initialContext","initialSkillTest","appReducers","combineReducers","action","nextScenario","prevScenario","tokenAction","scenarioSpec","contextAction","assign","contextToggleAction","skillTestAction","loadCurrentLang","appLang","localStorage","getItem","userLang","navigator","language","dashPosition","indexOf","substring","preloadCampaign","storageStateString","JSON","parse","loadStorageStage","campaignSpecId","cId","currentCharacter","currentContext","startAlvaroLaEraOlvidada","currentScenarioSpec","initialState","store","createStore","subscribe","getState","newStorageCampaign","setItem","stringify","CampaignWizardChanger","setCampaign","close","selectCampaign","campaignWizard","setCampaignWizard","campaignId","WizardStep2","setCampaignFromWizard","WizardStep3","contains","characterId","some","ch","addCharacter","ev","error","component","FormLabel","FormGroup","FormControlLabel","control","Checkbox","label","Flags","require","TokHeader","modalOpen","setModalOpen","i18n","myLang","themeSpec","campaignName","nonAsciiCharsInName","changeLang","changeLanguage","saveLang","float","GB","ES","variantMapping","h1","overflowY","App","changeScenario","ThemeProvider","CssBaseline","Container","maxWidth","Boolean","window","location","hostname","match","i18","use","initReactI18next","init","resources","es","translation","lng","fallbackLng","I18n","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","then","registration","unregister","catch","console","message"],"mappings":"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","file":"static/js/main.83d752b2.chunk.js","sourcesContent":["export function incDecNatural(previous: number, incDec: boolean) {\n    return incDec ? previous + 1 : Math.max(0, previous - 1);\n}\n\nexport function repeat(num: number, f: () => void) {\n    for (let i = 0; i < num; i++) {\n        f();\n    }\n}\n\nexport function repeatMap<T>(num: number, f: (index: number) => T): T[] {\n    const list = []\n    for (let i = 0; i < num; i++) {\n        list.push(f(i));\n    }\n    return list;\n}\n\nexport function nonAscii(aString: string) {\n    const ascii = /^[ -~]+$/;\n    return !ascii.test(aString);\n}\n\nexport interface Translation {\n    [k: string]: string\n}\n","import {AHCharacter} from \"./AHCharacter\";\nimport {incDecNatural} from \"../Utils\";\nimport * as uuid from \"uuid\";\n\nexport interface TokenSpec {\n    id: string;\n    value: number,\n    count: number,\n    name: string,\n    chaos: boolean\n}\nexport type EffectSpec = (tokenBag: TokenBag) => number;\n\nexport const elderSignEffect = (tokenBag: TokenBag) => tokenBag.character.elderSignEffect(tokenBag);\n\nexport interface Token extends TokenSpec {\n    effect: EffectSpec;\n}\n\nexport function tokenSpecDef(value: number, count: number, chaos = false, name?: string): TokenSpec {\n    const actualName = name ?? \"Token\" + value;\n    return {\n        value, count, chaos,\n        name: actualName,\n        id: actualName + \"_\" + uuid.v4()\n    }\n}\n\nfunction copyTokenSpec(tokenSpec: TokenSpec): TokenSpec {\n    return {\n        ...tokenSpec\n    }\n}\n\nfunction decCount(t: Token) {\n    return {...t, count: t.count - 1};\n}\n\nexport interface TokenBagSpec {\n    tokens: TokenSpec[];\n}\n\nfunction findName(tokenBagSpec: TokenBagSpec, name: string): TokenSpec | undefined {\n    return tokenBagSpec.tokens.find(t => t.name === name);\n}\n\nexport function removeToken(tokenBagSpec: TokenBagSpec, tokenName: string): TokenBagSpec {\n    const newBag = {\n        tokens: tokenBagSpec.tokens.map(ts => copyTokenSpec(ts))\n    }\n    const tokenSpecInBag = findName(newBag, tokenName);\n    if (tokenSpecInBag) {\n        tokenSpecInBag.count-=1;\n    }\n    newBag.tokens = newBag.tokens.filter(ts => ts.count > 0);\n    return newBag;\n}\n\nexport function addTokens(tokenBagSpec: TokenBagSpec, ...tokens: TokenSpec[]): TokenBagSpec {\n    const newBag = {\n        tokens: tokenBagSpec.tokens.map(ts => copyTokenSpec(ts))\n    }\n    tokens.forEach(tokenSpec => {\n        const tokenSpecInBag = findName(newBag, tokenSpec.name);\n        if (tokenSpecInBag) {\n            tokenSpecInBag.count += tokenSpec.count\n        } else {\n            newBag.tokens.push(tokenSpec);\n        }\n    })\n    return newBag;\n}\n\n\nexport function buildBagSpec(...tokens: TokenSpec[]): TokenBagSpec {\n    return {tokens}\n}\n\nexport function allTokenSpecs(bagSpec: TokenBagSpec): TokenSpec[] {\n    const allTokensIndividually: TokenSpec[] = [];\n    bagSpec.tokens.forEach( t => {\n        for(let i = 0; i < t.count; i++) allTokensIndividually.push({...t, count: 1});\n    })\n    return allTokensIndividually;\n}\n\nexport function allKnownTokens(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(2, 1, false, 'elderSign'),\n        tokenSpecDef(1, 1, false),\n        tokenSpecDef(0, 1, false),\n        tokenSpecDef(-1, 1, false),\n        tokenSpecDef(-2, 1, false),\n        tokenSpecDef(-3, 1, false),\n        tokenSpecDef(-4, 1, false),\n        tokenSpecDef(-5, 1, false),\n        tokenSpecDef(-6, 1, false),\n        // tokenSpecDef(-7, 1, false),\n        tokenSpecDef(-8, 1, false),\n        // tokenSpecDef(-9, 1, false),\n        tokenSpecDef(0, 1, true, 'Calavera'),\n        tokenSpecDef(0, 1, true, 'Sectario'),\n        tokenSpecDef(0, 1, true, 'Lápida'),\n        tokenSpecDef(0, 1, true, 'Antiguo'),\n        tokenSpecDef(2, 1, true, 'Blessed'),\n        tokenSpecDef(-2, 1, true, 'Cursed'),\n        FALLO_AUTOMATICO\n    );\n}\n\nexport function commonTokenEffectSpec(): ScenarioEffectSpecs {\n    return [\n        {name: \"elderSign\", effect: (tokenBag) => tokenBag.character.elderSignEffect(tokenBag)},\n        {name: \"Blessed\", effect: (tokenBag) => 2 + tokenAverage(seal(tokenBag, \"Blessed\"))},\n        {name: \"Cursed\", effect: (tokenBag) => -2 + tokenAverage(seal(tokenBag, \"Cursed\"))},\n    ];\n\n}\n\nexport type ScenarioContext = { [key: string]: number|boolean };\nexport function incDecContextNatural(state: ScenarioContext, key: string, incDec: boolean) {\n    return incDecNatural(state[key] as number, incDec);\n}\nexport function incContextValue(context: ScenarioContext, key: string): ScenarioContext {\n    const newValue: number = ((context[key] as number) ?? 0) + 1;\n    const newContext = {\n        ...context,\n        [key]: newValue\n    }\n    return newContext;\n}\n\nexport function decContextValue(context: ScenarioContext, key: string): ScenarioContext {\n    let oldValue: number = (context[key] as number) ?? 0;\n    let newContext = context;\n    if (oldValue > 0) {\n        const newValue = oldValue - 1;\n        newContext = {\n            ...context,\n            [key]: newValue\n        }\n    }\n    return newContext;\n}\n\nexport function toggleContextValue(context: ScenarioContext, key: string): ScenarioContext {\n    const oldValue = context[key] as boolean;\n    return {\n        ...context,\n        [key]: !oldValue\n    };\n}\n\nexport interface TokenBag {\n    context: ScenarioContext;\n    character: AHCharacter;\n    tokens: Token[];\n}\n\nexport type ScenarioEffectSpecs = { name: string, effect: EffectSpec }[];\n\nexport function buildEffectSpecs(...effectSpecs: ScenarioEffectSpecs): Map<string, EffectSpec> {\n    const effectMap = new Map<string, EffectSpec>();\n    effectSpecs.forEach( ns => effectMap.set(ns.name, ns.effect));\n    return effectMap;\n}\n\nexport function buildBagFromSpec(bagSpec: TokenBagSpec, effects: Map<string, EffectSpec>, character: AHCharacter, context: ScenarioContext): TokenBag {\n    return {\n        character,\n        context,\n        tokens: bagSpec.tokens.map(tokenSpec => tokenDef(tokenSpec, effects.get(tokenSpec.name)))\n    }\n}\n\n\n\nexport function tokenDef(tokenSpec: TokenSpec, effect?: EffectSpec): Token {\n    return {\n        ...tokenSpec,\n        effect: effect ?? (() => tokenSpec.value),\n    }\n}\n\nconst FALLO_AUTOMATICO_VALUE = -99\n\nexport const FALLO_AUTOMATICO = tokenSpecDef(FALLO_AUTOMATICO_VALUE, 1, true, \"Fallo\");\n\nfunction sortTokens(tokenBag: TokenBag) {\n    return tokenBag.tokens.sort((a, b) => b.effect(tokenBag) - a.effect(tokenBag));\n}\n\nexport function tokenFloatAverage(tokenBag: TokenBag) {\n    const tokens = tokenBag.tokens;\n    let numOfTokens = 0;\n    const total = tokens.reduce<number>((sum, token) => {\n        if (token.effect(tokenBag) !== FALLO_AUTOMATICO_VALUE) {\n            numOfTokens += token.count;\n            return sum + (token.effect(tokenBag) * token.count)\n        } else {\n            return sum;\n        }\n    }, 0);\n    return total / numOfTokens;\n}\n\nexport function tokenAverage(tokenBag: TokenBag): number {\n    return Math.floor(tokenFloatAverage(tokenBag));\n}\n\ninterface ValueCount {\n    value: number;\n    count: number;\n}\n\nexport function tokensWithValue(tokenBag: TokenBag, value: number): Token[] {\n    const tokens = [];\n    const sorted = sortTokens(tokenBag);\n    let i = 0;\n    while (i < sorted.length && sorted[i].effect(tokenBag) >= value) {\n        if (sorted[i].effect(tokenBag) === value) {\n            for (let j=0; j < sorted[i].count; j++) {\n                tokens.push(sorted[i]);\n            }\n        }\n        i++;\n    }\n    return tokens;\n}\n\nexport function histogram(tokenBag: TokenBag) {\n    return sortTokens(tokenBag).reduce<ValueCount[]>((previousValues: ValueCount[], token: Token) => {\n        const last = previousValues.length >= 1 ? previousValues[previousValues.length - 1] : undefined;\n        if (last && last.value === token.effect(tokenBag)) {\n            last.count = last.count + token.count;\n        } else {\n            previousValues.push({value: token.effect(tokenBag), count: token.count});\n        }\n        return previousValues;\n    }, []);\n}\n\nexport function accumulated(tokenBag: TokenBag) {\n    return histogram(tokenBag).reduce<ValueCount[]>((prev, curr: ValueCount) => {\n        const prevValue = prev.length > 0 ? prev[prev.length - 1].count : 0;\n        return prev.concat({value: curr.value, count: curr.count + prevValue});\n    }, []);\n}\n\n\n\nexport function sealAll(tokenBag: TokenBag, tokenName: string): TokenBag {\n    const tokensFiltered: Token[] = tokenBag.tokens.map(t => {\n        return t.name !== tokenName ? t : null\n    }).filter(t => t !== null) as Token[];\n    return {\n        ...tokenBag,\n        tokens: tokensFiltered,\n    }\n}\n\nexport function seal(tokenBag: TokenBag, tokenName: string): TokenBag {\n    const tokensFiltered = tokenBag.tokens.map(t => {\n        return t.name !== tokenName ? t : decCount(t)\n    }).filter(t => t.count > 0)\n    return {\n        ...tokenBag,\n        tokens: tokensFiltered\n    }\n}\n\nexport function allTokens(bag: TokenBag): Token[] {\n    const allTokensIndividually: Token[] = [];\n    bag.tokens.forEach( t => {\n        for(let i = 0; i < t.count; i++) allTokensIndividually.push({...t, count: 1, id: t.id + \"_\" + i});\n    })\n    return allTokensIndividually;\n}\n\n\n// TokenBagPassZone\nexport interface WithTokenBag {\n    tokenBag: TokenBag;\n}\nexport interface ITokensInPassLine {\n    tokens: Token[];\n    prob: number;\n}\nexport type TokenBagPassZone = Map<number, ITokensInPassLine> & WithTokenBag;\nexport function tokenBagPassZone(tokenBag: TokenBag): TokenBagPassZone {\n    const accum = accumulated(tokenBag);\n    const map = new Map<number, ITokensInPassLine>() as TokenBagPassZone;\n    map.tokenBag = tokenBag;\n    const total = accum[accum.length - 1].count;\n    accum.forEach(vc => {\n        if (vc.value !== FALLO_AUTOMATICO_VALUE) {\n            const prob = 100 * vc.count / total;\n            const tokens = tokensWithValue(tokenBag, vc.value);\n            map.set(vc.value, {tokens, prob});\n        }\n    });\n    return map;\n}\n\nexport interface ISkillLine {\n    key: number;\n    tokens: Token[];\n    prob: number;\n    pass: boolean;\n    firstFail: boolean;\n    currentProb: boolean;\n}\n\nexport function passZoneLines(tokenBagMap: TokenBagPassZone, skill: number, test: number): ISkillLine[] {\n    const lines: ISkillLine[] = [];\n    let stillPass = true;\n    tokenBagMap.forEach((value, key) => {\n        const result = Math.max(skill+key, 0);\n        const pass = result >= test;\n        const nextPass = Math.max(result -1, 0) >= test;\n        const currentProb = pass && !nextPass;\n        const firstFail = !pass && stillPass;\n        stillPass = pass;\n        lines.push({\n            key,\n            tokens: value.tokens,\n            prob: value.prob,\n            pass,\n            firstFail,\n            currentProb\n        });\n    });\n    return lines;\n}\n\nexport function printSkillLine(tokenBagMap: TokenBagPassZone, skill: number, test: number): string {\n    let output = \"\";\n    output+=\"******************\\n\";\n    output+=`Skill: ${skill}, Test: ${test}\\n`;\n    output+=\"******************\\n\";\n    const lines = passZoneLines(tokenBagMap, skill, test);\n    lines.forEach(line => {\n        const keyFormat = line.key.toString().padStart(2, \" \");\n        if (line.firstFail) {\n            output+=\"------------------\\n\";\n        }\n        output+=`${keyFormat} => ${line.prob.toFixed(2)}% ${line.currentProb ? \"<----\":\"     \"}`;\n        output+=\"[\" + line.tokens.map(t => t.name).join(',') + \"]\\n\";\n    });\n    output+=\"******************\\n\";\n    return output;\n}\n\nexport function nnDec(nn: number): number {\n    return Math.max(nn -1 , 0);\n}\n\n\n","import {TokenSpec} from \"./Token\";\nimport React, {useState} from \"react\";\nimport {Fade} from \"@material-ui/core\";\n\nexport function TokenSpan(props: {token: TokenSpec, onClick?: (token: TokenSpec) => void, fadeOut?: boolean, fadeOutFadeIn?: boolean}){\n    const [fadeIn, setFadeIn] = useState(true);\n    const handler = () => {\n        if (props.onClick) {\n            if (props.fadeOut || props.fadeOutFadeIn) {\n                setFadeIn(false);\n            } else {\n                props.onClick(props.token);\n            }\n        }\n    };\n    const fadeExitedHandler = () => {\n        if (props.onClick) {\n            props.onClick(props.token);\n        }\n        setFadeIn(true);\n    }\n    return (\n        <Fade in={fadeIn} onExited={fadeExitedHandler}>\n            <span style={{cursor: \"pointer\"}} className={\"Token \" + props.token.name} onClick={handler}>T</span>\n        </Fade>\n    )\n}","import React from \"react\";\nimport {IContextValueSpec} from \"./Scenario\";\nimport {IconButton, InputLabel, Switch} from \"@material-ui/core\";\nimport {useTranslation} from \"react-i18next\";\n\nexport function ContextValueChanger(props: {\n    currentValue: number | boolean, valueSpec: IContextValueSpec, incDecContextValue: (incDec: boolean) => void, toggleContextValue: () => void}) {\n    const valueSpec = props.valueSpec;\n    const { t } = useTranslation();\n    if (valueSpec.type === \"number\") {\n        return (\n            <NumericParamChanger inline={false} name={t(valueSpec.name)} currentValue={props.currentValue as number}\n                                 incValue={() => props.incDecContextValue(true)}\n                                 decValue={() => props.incDecContextValue(false)} />\n        )\n    } else {\n        return (\n            <BooleanParamChanger name={t(valueSpec.name)} currentValue={props.currentValue as boolean}\n                                 toggle={() => props.toggleContextValue()}/>\n        )\n    }\n}\n\ntype NumericParamChangerProps =\n    { inline: boolean, name: string, currentValue: number, incValue: () => void, decValue: () => void };\n\nexport function NumericParamChanger({inline, name, currentValue, incValue, decValue}: NumericParamChangerProps) {\n    const incDecStyle = {verticalAlign: \"middle\"};\n    return (\n        <div className=\"ParamChanger\">\n            {inline ? <span>{name}</span> : <InputLabel>{name}</InputLabel>}\n            <IconButton className=\"IconAction material-icons\" style={incDecStyle} onClick={_ => incValue()}>arrow_circle_up</IconButton>\n            {currentValue}\n            <IconButton className=\"IconAction material-icons\" style={incDecStyle} onClick={_ => decValue()}>arrow_circle_down</IconButton>\n        </div>\n    )\n}\n\ntype BooleanParamChangerProps = { name: string, currentValue: boolean, toggle: () => void };\n\nexport function BooleanParamChanger({name, currentValue, toggle}: BooleanParamChangerProps) {\n    return (\n        <div className=\"ParamChanger\">\n            <InputLabel>{name}:</InputLabel>\n            <Switch\n                checked={currentValue}\n                onChange={_ => toggle()}\n                color=\"primary\"\n                name=\"name\"\n                inputProps={{ 'aria-label': 'primary checkbox' }}\n            />\n        </div>\n    )\n}","import {Action} from \"redux\";\nimport {AHCharacter} from \"./tok/AHCharacter\";\nimport {IScenarioSpec} from \"./tok/Scenario\";\nimport {TokenSpec} from \"./tok/Token\";\nimport {Campaign} from \"./tok/Campaign\";\n\nexport interface IAppAction extends Action {}\nexport interface ICampaignAction extends IAppAction {}\nexport interface ICampaignSelectAction extends ICampaignAction { campaign: Campaign }\nexport interface IScenarioAction extends IAppAction { scenarioSpec: IScenarioSpec }\nexport interface ICharacterAction extends IAppAction { character: AHCharacter }\nexport interface IContextAction extends IAppAction { key: string }\nexport interface IIncDecAction extends IAppAction { incDec: boolean }\nexport interface ITokenAction extends IAppAction { tokenSpec: TokenSpec}\n\n// Campaign\nexport const SELECT_CAMPAIGN = 'SELECT_CAMPAIGN';\nexport const NEXT_SCENARIO = 'NEXT_SCENARIO';\nexport const PREV_SCENARIO = 'PREV_SCENARIO';\n// Scenario\nexport const CHANGE_SCENARIO = 'CHANGE_SCENARIO';\n\n// Character\nexport const CHANGE_CHARACTER = 'CHANGE_CHARACTER';\n\n// Context\nexport const INC_DEC_CONTEXT_VALUE = 'INC_DEC_CONTEXT_VALUE';\nexport const TOGGLE_CONTEXT_VALUE = 'TOGGLE_CONTEXT_VALUE';\n\n// SkillTest\nexport const CHANGE_SKILL = 'CHANGE_SKILL';\nexport const CHANGE_TEST = 'CHANGE_TEST';\n\n//BagTokenSpec\nexport const ADD_TOKEN = 'ADD_TOKEN';\nexport const REMOVE_TOKEN = 'REMOVE_TOKEN';\n\n//Campaign Wizard\nexport const SELECT_CAMPAIGN_SPEC = 'SELECT_CAMPAIGN_SPEC';\n\nexport function selectCampaign(campaign: Campaign): ICampaignSelectAction {\n    return {\n        type: SELECT_CAMPAIGN,\n        campaign\n    }\n}\n\nexport function advanceScenario(): ICampaignAction {\n    return {\n        type: NEXT_SCENARIO\n    }\n}\n\nexport function getBackScenario(): ICampaignAction {\n    return {\n        type: PREV_SCENARIO\n    }\n}\n\n// Scenario\nexport function changeScenario(scenarioSpec: IScenarioSpec): IScenarioAction {\n    return {\n        type: CHANGE_SCENARIO,\n        scenarioSpec\n    }\n}\n// Character\nexport function changeCharacter(character: AHCharacter): ICharacterAction {\n    return {\n        type: CHANGE_CHARACTER,\n        character\n    }\n}\n\n// Context\nexport function incDecContextValue(key: string, incDec: boolean): IContextAction & IIncDecAction {\n    return {\n        type: INC_DEC_CONTEXT_VALUE,\n        key, incDec\n    }\n}\n\nexport function toggleContextValue(key: string): IContextAction {\n    return {\n        type: TOGGLE_CONTEXT_VALUE,\n        key\n    }\n}\n\n// SkillTest\nexport function changeSkill(incDec: boolean): IIncDecAction {\n    return {\n        type: CHANGE_SKILL,\n        incDec\n    }\n}\nexport const decreaseSkill = () => changeSkill(false);\nexport const increaseSkill = () => changeSkill(true);\n\nexport function changeTest(incDec: boolean): IIncDecAction {\n    return {\n        type: CHANGE_TEST,\n        incDec\n    }\n}\nexport const decreaseTest = () => changeTest(false);\nexport const increaseTest = () => changeTest(true);\n\nexport function addToken(tokenSpec: TokenSpec): ITokenAction {\n    return {\n        type: ADD_TOKEN,\n        tokenSpec\n    }\n}\n\nexport function removeToken(tokenSpec: TokenSpec): ITokenAction {\n    return {\n        type: REMOVE_TOKEN,\n        tokenSpec\n    }\n}\n","import {Typography} from \"@material-ui/core\";\nimport {NumericParamChanger} from \"./ParamChanger\";\nimport React from \"react\";\nimport {connect} from \"react-redux\";\nimport {AppState} from \"../AppState\";\nimport {Dispatch} from \"redux\";\nimport {decreaseSkill, decreaseTest, increaseSkill, increaseTest} from \"../AppActions\";\nimport {useTranslation} from \"react-i18next\";\n\nconst mapStateToProps = (state: AppState) => {\n    return {\n        skill: state.skillTest.skill,\n        test: state.skillTest.test\n    }\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => {\n    return {\n        incSkill: () => dispatch(increaseSkill()),\n        decSkill: () => dispatch(decreaseSkill()),\n        incTest: () => dispatch(increaseTest()),\n        decTest: () => dispatch(decreaseTest())\n    }\n}\n\nexport const CurrentSkillTestChanger = connect(mapStateToProps, mapDispatchToProps)(SkillTestChanger);\n\nfunction SkillTestChanger(props: {skill: number, test: number,\n                                  incSkill: () => void, decSkill: () => void,\n                                  incTest: () => void, decTest: () => void}) {\n    const {skill, test, incSkill, decSkill, incTest, decTest} = props;\n    const { t } = useTranslation();\n    return (\n        <Typography variant=\"h5\">\n            <NumericParamChanger inline={true} name={t('Skill')} currentValue={skill} incValue={incSkill} decValue={decSkill}/>\n            <NumericParamChanger inline={true} name={t('Test')} currentValue={test} incValue={incTest} decValue={decTest}/>\n        </Typography>\n    );\n}","import React from \"react\";\nimport {passZoneLines, ISkillLine, TokenBagPassZone, TokenBag, tokenBagPassZone} from \"./Token\";\nimport \"./Tok.css\"\nimport {TokenSpan} from \"./TokenSpan\";\nimport {Grid, Typography} from \"@material-ui/core\";\nimport {CurrentSkillTestChanger} from \"./SkillTestChanger\";\nimport {SkillTest} from \"./SkillTest\";\nimport {connect} from \"react-redux\";\nimport {AppState} from \"../AppState\";\nimport {useTranslation} from \"react-i18next\";\n\nfunction mapStateToProps(state: AppState, ownProps: {tokenBag: TokenBag}) {\n    return {\n        passZone: tokenBagPassZone(ownProps.tokenBag),\n        skillTest: state.skillTest\n    }\n}\n\nexport const CurrentPassZone = connect(mapStateToProps)(PassZone);\n\nexport function PassZone({passZone, skillTest}: {passZone: TokenBagPassZone, skillTest: SkillTest}) {\n    const { t } = useTranslation();\n    const lines = passZoneLines(passZone, skillTest.skill, skillTest.test);\n    return (\n        <Grid container className=\"PassZone\" alignItems={\"center\"}>\n            <Grid item xs={12} sm={7} md={6} >\n            <Typography variant=\"h4\">{t('Pass zone')}</Typography>\n            <hr />\n            <Grid container direction=\"column\">\n                {\n                    lines.map(line => (\n                        <Grid key={line.key} item>\n                            <PassLine line={line} />\n                        </Grid>\n                    ))\n                }\n            </Grid>\n            <hr />\n            </Grid>\n            <Grid item xs={12} sm={5} md={6} style={{textAlign: \"center\"}}>\n                <CurrentSkillTestChanger />\n            </Grid>\n        </Grid>\n    )\n}\n\nfunction PassLine(props: {line: ISkillLine}) {\n    const line = props.line;\n    const liStyle = {\n        color: line.pass ? \"green\" : \"red\",\n    }\n    let lineSeparator;\n    if (line.firstFail) {\n        lineSeparator = <hr className=\"PassSeparator Current\"/>;\n    } else {\n        lineSeparator = <hr className=\"PassSeparator\" style={{borderColor: \"transparent\"}}/>;\n    }\n    return (\n        <div>{lineSeparator}\n        <Grid container  direction=\"row\"  alignItems=\"flex-start\" spacing={1}>\n            <Grid item style={{...liStyle, textAlign: \"center\"}} xs={2} sm={1}>\n                <Typography variant=\"h5\" >{line.key}</Typography>\n            </Grid>\n            <Grid item style={liStyle} className=\"LineProb\" xs={2} sm={2}>\n                <Typography variant=\"body1\">{line.prob.toFixed(2)}%</Typography>\n            </Grid>\n            <Grid item style={{textAlign: \"left\"}} xs={8} sm={9}>\n                <Typography variant=\"h3\" noWrap={true}>\n                {line.tokens.map((token, index) => (\n                    <TokenSpan key={index} token={token} />\n                ))}\n                </Typography>\n            </Grid>\n        </Grid>\n        </div>\n    )\n}\n","import {createStyles, FormControl, InputLabel, makeStyles, MenuItem, Select, Theme} from \"@material-ui/core\";\nimport {AppState} from \"../AppState\";\nimport {Dispatch} from \"redux\";\nimport {AHCharacter} from \"./AHCharacter\";\nimport {changeCharacter} from \"../AppActions\";\nimport {connect} from \"react-redux\";\nimport React from \"react\";\nimport {useTranslation} from \"react-i18next\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        formControl: {\n            margin: theme.spacing(1),\n            minWidth: 120,\n        },\n        selectEmpty: {\n            marginTop: theme.spacing(2),\n        },\n    }),\n);\n\nconst mapStateToProps = (state: AppState) => ({character: state.selectedCharacter, characters: state.selectedCampaign.characters});\nconst mapDispatchToProps = (dispatch: Dispatch) => ({setCharacter: (character: AHCharacter) => dispatch(changeCharacter(character))});\nexport const CurrentCharacterSelector = connect(\n    mapStateToProps,\n    mapDispatchToProps)(CharacterSelector);\n\nexport function CharacterSelector(props: {character: AHCharacter, characters: AHCharacter[], setCharacter: (character: AHCharacter) => void}) {\n    const {character, characters, setCharacter} = props;\n    const { t } = useTranslation();\n    const findCharacterByShortName = (shortName: string): AHCharacter | undefined => {\n        return characters.find(c => c.shortName === shortName);\n    }\n\n    return <div>\n        <InputLabel>{t('Current character')}:</InputLabel>\n        <FormControl variant=\"standard\" className={useStyles().formControl}>\n            <Select\n                labelId=\"character-selector-label\"\n                id=\"character-selector\"\n                value={character.shortName}\n                onChange={e => setCharacter(findCharacterByShortName(e.target.value as string)!)}>\n                {characters.map(aChar => (\n                    <MenuItem key={aChar.shortName} value={aChar.shortName}>{aChar.shortName}</MenuItem>\n                ))}\n            </Select>\n        </FormControl>\n    </div>;\n}","import {Campaign} from \"./tok/Campaign\";\nimport {IScenarioSpec} from \"./tok/Scenario\";\nimport {buildBagFromSpec, buildEffectSpecs, ScenarioContext, TokenBagSpec} from \"./tok/Token\";\nimport {SkillTest} from \"./tok/SkillTest\";\nimport {AHCharacter} from \"./tok/AHCharacter\";\n\nexport interface AppState {\n    selectedCampaign: Campaign;\n    bagSpec: TokenBagSpec;\n    selectedScenario: IScenarioSpec;\n    selectedCharacter: AHCharacter;\n    gameContext: ScenarioContext;\n    skillTest: SkillTest;\n}\n\nexport function buildBagFromState(appState: AppState) {\n    return buildBagFromSpec(\n        appState.bagSpec,\n        buildEffectSpecs(...appState.selectedScenario.scenarioEffectSpec),\n        appState.selectedCharacter,\n        appState.gameContext\n    );\n}\n","import {ScenarioContext, ScenarioEffectSpecs} from \"./Token\";\nimport {Translation} from \"../Utils\";\n\nexport interface IScenarioSpec {\n    name: string;\n    scenarioEffectSpec: ScenarioEffectSpecs;\n    contextSpec: IScenarioContextSpec;\n    translations: Translation;\n}\n\nexport function initContext(contextSpec: IScenarioContextSpec): ScenarioContext {\n    const context: ScenarioContext = {};\n    contextSpec.valuesSpec.forEach( vs => context[vs.name] = vs.initialValue)\n    return context;\n}\n\nexport interface IScenarioContextSpec {\n    valuesSpec: IContextValueSpec[];\n}\n\nexport function findValueSpec(contextSpec: IScenarioContextSpec, key: string) {\n    return contextSpec.valuesSpec.find(vs => vs.name === key);\n}\n\nexport type IContextValueType = \"number\" | \"boolean\";\n\nexport interface IContextValueSpec {\n    name: string;\n    description: string;\n    initialValue: number | boolean;\n    type: IContextValueType;\n    translations: Translation;\n}\n","import {connect} from \"react-redux\";\nimport {AppState} from \"../AppState\";\nimport React, {Dispatch} from \"react\";\nimport {\n    IContextAction,\n    IIncDecAction,\n    incDecContextValue,\n    toggleContextValue\n} from \"../AppActions\";\nimport {findValueSpec, IScenarioContextSpec} from \"./Scenario\";\nimport {Typography} from \"@material-ui/core\";\nimport {ContextValueChanger} from \"./ParamChanger\";\nimport {ScenarioContext} from \"./Token\";\n\nexport const CurrentScenarioContextManager = connect(\n    (state: AppState) => ({spec: state.selectedScenario.contextSpec, context: state.gameContext}),\n    (dispatch: Dispatch<IContextAction | IContextAction & IIncDecAction>) => ({\n        incDecContextValue: (key: string, incDec: boolean) => dispatch(incDecContextValue(key, incDec)),\n        toggleContextValue: (key: string) => dispatch(toggleContextValue(key))\n    })\n)(ContextManager);\ntype ContextManagerProps = {\n    spec: IScenarioContextSpec, context: ScenarioContext,\n    incDecContextValue: (key: string, incDec: boolean) => void,\n    toggleContextValue: (key: string) => void\n};\n\nfunction ContextManager({spec, context, incDecContextValue, toggleContextValue}: ContextManagerProps) {\n    return <Typography variant=\"h5\" style={{paddingTop: \"2vmin\"}}>\n        {Object.keys(context).map(contextKey => (\n            <ContextValueChanger key={contextKey} currentValue={context[contextKey]}\n                                 valueSpec={(findValueSpec(spec, contextKey)!)}\n                                 incDecContextValue={(incDec: boolean) => incDecContextValue(contextKey, incDec)}\n                                 toggleContextValue={() => toggleContextValue(contextKey)}/>\n        ))}\n    </Typography>\n\n}","import {makeStyles} from \"@material-ui/core/styles\";\nimport {createStyles, Theme} from \"@material-ui/core\";\n\nexport const useModalStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        paper: {\n            position: 'relative',\n            left: \"15%\",\n            top: \"25%\",\n            width: \"70%\",\n            opacity: 0.9,\n            backgroundColor: theme.palette.background.paper,\n            border : '2px solid',\n            borderColor: theme.palette.secondary.main,\n            boxShadow: theme.shadows[5],\n            padding: theme.spacing(2, 4, 3),\n        },\n    }),\n);","import {allKnownTokens, allTokens, TokenBag, TokenBagSpec, tokenFloatAverage, TokenSpec} from \"./Token\";\nimport {Box, Typography} from \"@material-ui/core\";\nimport {TokenSpan} from \"./TokenSpan\";\nimport {AppState} from \"../AppState\";\nimport {Dispatch} from \"redux\";\nimport {addToken, ITokenAction, removeToken} from \"../AppActions\";\nimport {connect} from \"react-redux\";\nimport React from \"react\";\nimport {useTranslation} from \"react-i18next\";\nimport {useModalStyles} from \"../CommonStyles\";\n\nexport function BagDisplay({tokenBag, showAverage = true, onClick, fadeOutTokens = false}:\n                               {tokenBag: TokenBag, showAverage?: boolean, onClick?: (token: TokenSpec) => void, fadeOutTokens: boolean}) {\n    const { t } = useTranslation();\n    return <div className=\"BagDisplay\">\n        {showAverage ? (<Typography>{t('Bag average')}: {tokenFloatAverage(tokenBag).toFixed(2)}</Typography>) : null }\n        <p className=\"TokenStrip\">\n            {allTokens(tokenBag).map((token, index) => (\n                <TokenSpan key={token.id} token={token} onClick={onClick} fadeOut={fadeOutTokens}/>\n            ))}\n        </p>\n    </div>\n}\n\nexport const CurrentTokenBagManager = connect(\n    (state: AppState, ownProps: { tokenBag: TokenBag }) => {\n        return {\n            tokenBag: ownProps.tokenBag\n        }\n    },\n    (dispatch: Dispatch<ITokenAction>) => {\n        return {\n            addToken: (token: TokenSpec) => dispatch(addToken(token)),\n            removeToken: (token: TokenSpec) => dispatch(removeToken(token)),\n        }\n    }\n)(TokenBagManager);\nfunction TokenBagManager({tokenBag, addToken, removeToken}: {tokenBag: TokenBag,\n    addToken: (token: TokenSpec) => void, removeToken: (token: TokenSpec) => void}) {\n    const classes = useModalStyles();\n    const { t }  = useTranslation();\n    const allKnown = allKnownTokens();\n    return (\n        <Box textAlign=\"center\" className={classes.paper}>\n            <Typography id=\"bag-management-title\" variant=\"h3\">{t('Chaos bag')}</Typography>\n            <Typography>{t('Current bag')}. {t('Select tokens to remove them')}</Typography>\n            <BagDisplay tokenBag={tokenBag} showAverage={false}\n                        onClick={(token: TokenSpec) => removeToken(token)} fadeOutTokens={true}/>\n            <Typography >{t('Select tokens to add them to the bag')}</Typography>\n            <BagSpecDisplay tokenBagSpec={allKnown} onClick={(token: TokenSpec) => addToken(token)}/>\n        </Box>\n    );\n}\n\nfunction BagSpecDisplay({tokenBagSpec, onClick}: {tokenBagSpec: TokenBagSpec, onClick?: (token: TokenSpec) => void}) {\n    return <div className=\"BagDisplay\">\n        <p className=\"TokenStrip\">\n            {tokenBagSpec.tokens.map((token, index) => (\n                <TokenSpan key={index} token={token} onClick={onClick} fadeOut={false} fadeOutFadeIn={true}/>\n            ))}\n        </p>\n    </div>\n}\n\n\n\n\n","import React, {useState} from \"react\";\nimport {IScenarioSpec} from \"./Scenario\";\nimport {CurrentPassZone} from \"./PassZone\";\nimport {TokenBag} from \"./Token\";\nimport {Box, Button, Modal, Typography} from \"@material-ui/core\";\nimport {CurrentCharacterSelector} from \"./CharacterSelector\";\nimport {connect} from \"react-redux\";\nimport {AppState, buildBagFromState} from \"../AppState\";\nimport {CurrentScenarioContextManager} from \"./ContextManager\";\nimport {BagDisplay, CurrentTokenBagManager} from \"./TokenBag\";\nimport {useTranslation} from \"react-i18next\";\n\n\nconst mapStateToProps = (state: AppState) => ({tokenBag: buildBagFromState(state), scenario: state.selectedScenario});\n\nexport const CurrentScenarioPassZone = connect(mapStateToProps)(ScenarioPassZone);\n\nexport function ScenarioPassZone({tokenBag, scenario}: {tokenBag: TokenBag, scenario: IScenarioSpec}) {\n    const [open, setOpen] = useState<boolean>(false);\n    const { t } = useTranslation();\n    return (\n        <div className=\"Scenario\">\n            <div className=\"ScenarioInfo\">\n                <Typography variant=\"h3\">{t(scenario.name)}</Typography>\n                <CurrentScenarioContextManager />\n                <CurrentCharacterSelector />\n            </div>\n            <CurrentPassZone tokenBag={tokenBag}/>\n\n            <BagDisplay tokenBag={tokenBag} onClick={() => setOpen(true)} fadeOutTokens={false}/>\n            <Modal open={open} onClose={() => setOpen(false)} aria-labelledby=\"bag-management-title\">\n                <CurrentTokenBagManager tokenBag={tokenBag}/>\n            </Modal>\n            <Box textAlign={\"center\"}>\n                <Button color=\"secondary\" onClick={() => setOpen(true)}>{t('Manage chaos bag')}</Button>\n            </Box>\n        </div>\n    );\n}\n","import {createMuiTheme, responsiveFontSizes} from \"@material-ui/core\";\n\nexport function tokTheme() {\n    const baseFontFamily = [\n        '-apple-system',\n        'BlinkMacSystemFont',\n        '\"Segoe UI\"',\n        'Roboto',\n        '\"Helvetica Neue\"',\n        'Arial',\n        'sans-serif',\n        '\"Apple Color Emoji\"',\n        '\"Segoe UI Emoji\"',\n        '\"Segoe UI Symbol\"',\n    ];\n    const birminghamFontFamily = \"Birmingham\";\n    const uglyQuaFontFamily = 'UglyQua';\n    const theme = responsiveFontSizes(createMuiTheme({\n        typography: {\n            fontFamily: [uglyQuaFontFamily].concat(baseFontFamily).join(','),\n            fontSize: 14\n        },\n        palette: {\n            tonalOffset: 1,\n            type: \"dark\",\n            primary: {\n                main: \"#205b57\",\n            },\n            secondary: {\n                main: \"#f4ebcc\",\n            }\n        }\n    }));\n\n    const headerFontFamily = [birminghamFontFamily].concat(baseFontFamily).join(',');\n    const headerFontFamilyNonAscii = [uglyQuaFontFamily].concat(baseFontFamily).join(',');\n    return {\n        theme,\n        headerFontFamily,\n        headerFontFamilyNonAscii\n    };\n}","import {EffectSpec} from \"./Token\";\n\nexport interface AHCharacter {\n    id: string,\n    name: string;\n    shortName: string;\n    elderSignEffect: EffectSpec;\n}\n\n\nexport const AHCharacters: {[key: string]: AHCharacter} = {\n    JoeDiamond: {id: \"JoeDiamond\", name: \"Joe Diamond\", shortName: \"Joe\", elderSignEffect: () => 1},\n    DianaStanley: {id: \"DianaStanley\", name: \"Diana Stanley\", shortName: \"Diana\", elderSignEffect: () => 2},\n    LeoAnderson: {id: \"LeoAnderson\", name: \"Leo Anderson\", shortName: \"Leo\", elderSignEffect: () => 2},\n    UrsulaDowns: {id: \"UrsulaDowns\", name: \"Ursula Downs\", shortName: \"Ursula\", elderSignEffect: () => 2},\n    LolaHayes: {id: \"LolaHayes\", name: \"Lola Hayes\", shortName: \"Lola\", elderSignEffect: () => 2},\n    LukeRobinson: {id: \"LukeRobinson\", name: \"Luke Robinson\", shortName: \"Luke\", elderSignEffect: () => 1},\n    MandyThompson: {id: \"MandyThompson\", name: \"Mandy Thompson\", shortName: \"Mandy\", elderSignEffect: () => 0},\n    TonyMorgan: {id: \"TonyMorgan\", name: \"Tony Morgan\", shortName: \"Tony\", elderSignEffect: () => 2},\n    PatriceHathaway: {id: \"PatriceHathaway\", name: \"Patrice Hathaway\", shortName: \"Patrice\", elderSignEffect: () => 1},\n    SisterMary: {id: \"SisterMary\", name: \"Sister Mary\", shortName: \"Mary\", elderSignEffect: () => 1},\n    TrishScarborough: {id: \"TrishScarborough\", name: \"Trish Scarborough\", shortName: \"Trish\", elderSignEffect: () => 2},\n    DexterDrake: {id: \"DexterDrake\", name: \"Dexter Drake\", shortName: \"Dexter\", elderSignEffect: () => 2},\n    Malasombra: {id: \"Malasombra\", name: '\"Skids\" O\\'Toole', shortName: \"Malasombra\", elderSignEffect: () => 1},\n    MarkHarrigan: {id: \"MarkHarrigan\", name: 'Mark Harrigan', shortName: \"Mark\", elderSignEffect: () => 2},\n    Sefina: {id: \"Sefina\", name: 'Sefina Rousseau', shortName: \"Sefina\", elderSignEffect: () => 3},\n}","import {\n    buildBagSpec, commonTokenEffectSpec,\n    elderSignEffect,\n    FALLO_AUTOMATICO,\n    seal,\n    tokenAverage,\n    TokenBag,\n    TokenBagSpec,\n    tokenSpecDef\n} from \"./Token\";\nimport {Campaign, ICampaignSpec} from \"./Campaign\";\nimport {IScenarioSpec} from \"./Scenario\";\nimport {AHCharacters} from \"./AHCharacter\";\n\nfunction easy(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 2),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,1),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Antiguo\"),\n        FALLO_AUTOMATICO\n    );\n}\nexport function normal(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 1),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 1),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Antiguo\"),\n        FALLO_AUTOMATICO\n    );\n}\nfunction hard (): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 1),\n        tokenSpecDef(0, 2),\n        tokenSpecDef(-1, 1),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(-6, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Antiguo\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction expert (): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 1),\n        tokenSpecDef(-1, 1),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 2),\n        tokenSpecDef(-6, 1),\n        tokenSpecDef(-8, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Antiguo\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction NaturalezaSalvaje(): IScenarioSpec {\n    const PUNTOS_DE_VENGANZA=\"Vengeance points\";\n    const LUGARES_EN_JUEGO=\"Locations in play\";\n    const CARTAS_EXPLORACION=\"Cards in exploration deck\";\n    const ENVENENADO=\"Poisoned\";\n\n    return {\n        name: \"The Untamed Wilds\",\n        translations: {\n            \"es\": \"Naturaleza Salvaje\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => 0 - (tokenBag.context[PUNTOS_DE_VENGANZA] as number)},\n            {name: \"Sectario\", effect: (tokenBag) => 0 - Math.min(5, tokenBag.context[LUGARES_EN_JUEGO] as number)},\n            {name: \"Lápida\", effect: (tokenBag) => 0 - Math.min(5, tokenBag.context[CARTAS_EXPLORACION] as number)},\n            {name: \"Antiguo\", effect: (tokenBag) => tokenBag.context[ENVENENADO] ? -99 : -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: PUNTOS_DE_VENGANZA,\n                description: \"Puntos de Venganza en la zona de victoria\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Puntos de venganza\"\n                }\n            },{\n                name: LUGARES_EN_JUEGO,\n                description: \"Lugares en juego\",\n                type: \"number\",\n                initialValue: 1,\n                translations: {\n                    \"es\": \"Lugares en juego\"\n                }\n            },{\n                name: CARTAS_EXPLORACION,\n                description: \"Lugares en el mazo de exploración\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Cartas en el mazo de exploración\"\n                }\n            },{\n                name: ENVENENADO,\n                description: \"Envenenado\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Envenenado\"\n                }\n            }]\n        }\n    };\n}\n\nfunction LaPerdicionDeEztli(): IScenarioSpec {\n    const FICHAS_PERDICION=\"Locations with doom\";\n    const PERDICION_EN_TU_LUGAR=\"Doom on your location\";\n    function fichas(tokenBag: TokenBag) {\n        return 0 - (tokenBag.context[FICHAS_PERDICION] as  number);\n    }\n    return {\n        name: \"The Doom of Eztli\",\n        translations: {\n            \"es\": \"La perdición de Eztli\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => tokenBag.context[PERDICION_EN_TU_LUGAR] ? -3 : -1},\n            {name: \"Sectario\", effect: (tokenBag) => fichas(tokenBag)},\n            {name: \"Lápida\", effect: (tokenBag) => fichas(tokenBag)},\n            {name: \"Antiguo\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Antiguo\"))},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: FICHAS_PERDICION,\n                description: \"Number of locations with doom on them\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Lugares con perdición\"\n                }\n            },{\n                name: PERDICION_EN_TU_LUGAR,\n                description: \"Doom on yout location\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Perdición en tu lugar\"\n                }\n            }]\n        }\n    };\n}\n\nfunction LosHilosDelDestino(): IScenarioSpec {\n    const MAYOR_PERDICION_EN_CULTISTA=\"Highest doom\";\n    return {\n        name: \"Threads of Fate\",\n        translations: {\n            \"es\": \"Los hilos del destino\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => 0 - (tokenBag.context[MAYOR_PERDICION_EN_CULTISTA] as number)},\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (tokenBag) => -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: MAYOR_PERDICION_EN_CULTISTA,\n                description: \"Highest number of doom in a cultist\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Mayor perdición en un cultista\"\n                }\n            }]\n        }\n    };\n}\n\nfunction ElLimiteDelOtroLado(): IScenarioSpec {\n    const LUGAR_ANTIGUO=\"Ancient location\";\n    return {\n        name: \"The Boundary Beyond\",\n        translations: {\n            \"es\": \"El límite del otro lado\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => (tokenBag.context[LUGAR_ANTIGUO] as boolean) ? -3 : -1},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Lápida\"))},\n            {name: \"Antiguo\", effect: (tokenBag) => -4},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: LUGAR_ANTIGUO,\n                description: \"You are at an ancient location\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Lugar antiguo\"\n                }\n            }]\n        }\n    };\n}\n\nfunction ElCorazonDeLosAncianos(): IScenarioSpec {\n    const EN_UNA_CUEVA=\"Cave location\";\n    const ENVENENADO=\"Poisoned\";\n    return {\n        name: \"Heart of the Elders\",\n        translations: {\n            \"es\": \"El corazón de los ancianos\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => (tokenBag.context[EN_UNA_CUEVA] as boolean) ? -3 : -1},\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (tokenBag) => (tokenBag.context[ENVENENADO] as boolean) ? -99 : -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: EN_UNA_CUEVA,\n                description: \"You are at in a cave location\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Lugar cueva\"\n                }\n            },{\n                name: ENVENENADO,\n                description: \"You are poisoned\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Envenenado\"\n                }\n            }]\n        }\n    };\n}\n\nfunction LaCiudadDeLosArchivos(): IScenarioSpec {\n    const CARTAS_EN_LA_MANO=\"Cards in hand\";\n\n    return {\n        name: \"The City of Archives\",\n        translations: {\n            \"es\": \"La ciudad de los archivos\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => (tokenBag.context[CARTAS_EN_LA_MANO] as number) >= 5 ? -3 : -1},\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (tokenBag) => -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: CARTAS_EN_LA_MANO,\n                description: \"Cards in hand\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Cartas en la mano\"\n                }\n            }]\n        }\n    };\n}\n\nfunction LasProfundidadesDeYoth(): IScenarioSpec {\n    const NIVEL_DE_PROFUNDIDAD=\"Depth level\";\n    const PUNTOS_DE_VENGANZA=\"Vengeance points\";\n    return {\n        name: \"The Depths of Yoth\",\n        translations: {\n            \"es\": \"Las profundidades de Yoth\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => 0 - (tokenBag.context[NIVEL_DE_PROFUNDIDAD] as number)},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Lápida\"))},\n            {name: \"Antiguo\", effect: (tokenBag) => (tokenBag.context[PUNTOS_DE_VENGANZA] as number) >= 3 ? -99 : -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: NIVEL_DE_PROFUNDIDAD,\n                description: \"Current Depth level\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Nivel de profundidad\"\n                }\n            },{\n                name: PUNTOS_DE_VENGANZA,\n                description: \"Vengeance points in the victory display\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Puntos de venganza\"\n                }\n            }]\n        }\n    };\n}\n\nfunction EonesDestozados(): IScenarioSpec {\n    const RELIQUIA_DE_LAS_ERAS_EN_TU_LUGAR=\"Relic of ages at your location\";\n    const ENVENENADO=\"Poisoned\";\n    return {\n        name: \"Shattered Aeons\",\n        translations: {\n            \"es\": \"Eones destrozados\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => (tokenBag.context[RELIQUIA_DE_LAS_ERAS_EN_TU_LUGAR] as boolean) ? -4 : -2},\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (tokenBag) => (tokenBag.context[ENVENENADO] as boolean) ? -99 : -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: RELIQUIA_DE_LAS_ERAS_EN_TU_LUGAR,\n                description: \"Relic of ages at your location\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Reliquia de las eras en tu lugar\"\n                }\n            },{\n                name: ENVENENADO,\n                description: \"You are poisoned\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Envenenado\"\n                }\n            }]\n        }\n    };\n}\n\nexport function buildLaEraOlvidadaCampaignSpec(): ICampaignSpec {\n    return {\n        id: \"TheForgottenAge\",\n        name: \"The Forgotten Age\",\n        scenarios: [\n            NaturalezaSalvaje(),LaPerdicionDeEztli(), LosHilosDelDestino(), ElLimiteDelOtroLado(),\n            ElCorazonDeLosAncianos(), LaCiudadDeLosArchivos(), LasProfundidadesDeYoth(), EonesDestozados()\n        ],\n        bagSpecsByLevel: {\n            easy: easy(),\n            normal: normal(),\n            hard: hard(),\n            expert: expert(),\n        },\n        translations: {\n            \"es\": \"La Era Olvidada\",\n        }\n    }\n}\n\nexport function startAlvaroLaEraOlvidada() {\n    const campaign = Campaign.start(buildLaEraOlvidadaCampaignSpec(), [\n        AHCharacters[\"LeoAnderson\"], AHCharacters[\"DianaStanley\"],\n    ], \"normal\");\n    campaign.startCampaign(0);\n    return campaign;\n}\n","import {\n    addTokens,\n    buildBagSpec, commonTokenEffectSpec,\n    FALLO_AUTOMATICO,\n    removeToken, seal,\n    tokenAverage,\n    TokenBagSpec,\n    tokenSpecDef\n} from \"./Token\";\nimport {IScenarioSpec} from \"./Scenario\";\nimport {ICampaignSpec} from \"./Campaign\";\n\nfunction easy(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 2),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 3),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        FALLO_AUTOMATICO\n    );\n}\nexport function normal(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 1),\n        tokenSpecDef(0, 2),\n        tokenSpecDef(-1, 3),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction hard (): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction expert (): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 1),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 2),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(-6, 1),\n        tokenSpecDef(-8, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction ActividadExtracurricular(): IScenarioSpec {\n    const CARDS_IN_DISCARD_PILE=\"Cards in your discard pile\";\n    const COST_OF_DISCARED_CARDS=\"Printed cost of discarded cards\";\n    return {\n        name: \"Extracurricular Activiry\",\n        translations: {\n            \"es\": \"Actividad extracurricular\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -1},\n            {name: \"Sectario\", effect: (tokenBag) => tokenBag.context[CARDS_IN_DISCARD_PILE] >= 10 ? -3 : -1},\n            {name: \"Antiguo\", effect: (tokenBag) => -tokenBag.context[COST_OF_DISCARED_CARDS]},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: CARDS_IN_DISCARD_PILE,\n                description: \"Cards in your discard pile\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Cartas en tu pila de descarte\"\n                }\n            }, {\n                name: COST_OF_DISCARED_CARDS,\n                description: \"Discard two cards X is the total printed cost of those discarded cardfs\",\n                type: \"number\",\n                initialValue: 3,\n                translations: {\n                    \"es\": \"Coste impreso de las cartas descartadas\"\n                }\n            }\n            ]\n        }\n    };\n}\n\nfunction LaCasaSiempreGana(): IScenarioSpec {\n    const SPEND_2_RESOURCES=\"Spend 2 resources to treat skull token as 0\";\n    return {\n        name: \"The House Always Win\",\n        translations: {\n            \"es\": \"La casa siempre gana\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => tokenBag.context[SPEND_2_RESOURCES] ? 0 : -2},\n            {name: \"Sectario\", effect: (tokenBag) => -3},\n            {name: \"Lápida\", effect: (tokenBag) => -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: SPEND_2_RESOURCES,\n                description: \"You may spend 2 resources to treat this token as a 0, instead.\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Gasta 2 recursos para tratar la calavera como un token 0\"\n                }\n            }]\n        }\n    };\n}\n\nfunction ElMuseoMiskatonic(): IScenarioSpec {\n    const HAUNTING_HORROR_AT_YOUR_LOCATION=\"Haunting horror at your location\";\n    return {\n        name: \"The Miskatonic Museum\",\n        translations: {\n            \"es\": \"El Museo Miskatonic\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => tokenBag.context[HAUNTING_HORROR_AT_YOUR_LOCATION] ? -3 : -1},\n            {name: \"Sectario\", effect: (tokenBag) => -1},\n            {name: \"Lápida\", effect: (tokenBag) => -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: HAUNTING_HORROR_AT_YOUR_LOCATION,\n                description: \"Haunting horror at your location\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Horrendo cazador está en tu Lugar\"\n                }\n            }]\n        }\n    };\n}\n\nfunction ElEssexCountyExpress(): IScenarioSpec {\n    const CURRENT_AGENDA=\"Current Agenda #\";\n    return {\n        name: \"Essex County Express\",\n        translations: {\n            \"es\": \"El Essex County Express\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -tokenBag.context[CURRENT_AGENDA]},\n            {name: \"Sectario\", effect: (tokenBag) => -1},\n            {name: \"Lápida\", effect: (tokenBag) => -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: CURRENT_AGENDA,\n                description: \"\",\n                type: \"number\",\n                initialValue: 1,\n                translations: {\n                    \"es\": \"Número de plan en curso\"\n                }\n            }]\n        }\n    };\n}\n\nfunction SangreEnElAltar(): IScenarioSpec {\n    const LOCATION_WITHOUT=\"Location cards in play with no card underneath\";\n    return {\n        name: \"Blood on the Altar\",\n        translations: {\n            \"es\": \"Sangre en el altar\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -Math.min(4, tokenBag.context[LOCATION_WITHOUT] as number)},\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (tokenBag) => -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: LOCATION_WITHOUT,\n                description: \"Location cards in play with no card underneath\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Lugares sin ninguna carta debajo\"\n                }\n            }]\n        }\n    };\n}\n\nfunction InvisiblesYSinDimension(): IScenarioSpec {\n    const BROOD_IN_PLAY=\"Brood in play\";\n    const REMOVE_A_CLUE_FROM_BROOD=\"Remove all clue tokens from a Brood\";\n    return {\n        name: \"Undimensioned and Unseen\",\n        translations: {\n            \"es\": \"Invisibles y sin dimension\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -tokenBag.context[BROOD_IN_PLAY]},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (tokenBag) => tokenBag.context[REMOVE_A_CLUE_FROM_BROOD] ? 0 : -4},\n            {name: \"Antiguo\", effect: (tokenBag) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: BROOD_IN_PLAY,\n                description: \"Brood of Yog-Sothoth in play\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Progenies en juego\"\n                }\n            },{\n                name: REMOVE_A_CLUE_FROM_BROOD,\n                description: \"Remove all clue tokens from a Brood\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Retirar todas las fichas de Pista de una Progenie\"\n                }\n            }]\n        }\n    };\n}\n\nfunction DondeAguardaLaPerdicion(): IScenarioSpec {\n    const ALTERED_LOCATION=\"Altered location\";\n    const AGENDA_2=\"Agenda 2\";\n    const COST_OF_DISCARED_CARDS=\"Printed cost of discarded cards\";\n    return {\n        name: \"Where Doom Awaits\",\n        translations: {\n            \"es\": \"Donde aguarda la perdición\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => tokenBag.context[ALTERED_LOCATION] ? -3 : -1},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (tokenBag) => tokenBag.context[AGENDA_2] ? -4 : -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -tokenBag.context[COST_OF_DISCARED_CARDS]},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: ALTERED_LOCATION,\n                description: \"At an altered location\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Lugar Alterado\"\n                }\n            }, {\n                name: AGENDA_2,\n                description: \"It's agenda 2\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Plan 2\"\n                }\n            }, {\n                name: COST_OF_DISCARED_CARDS,\n                description: \"Discard two cards X is the total printed cost of those discarded cardfs\",\n                type: \"number\",\n                initialValue: 3,\n                translations: {\n                    \"es\": \"Coste impreso de las cartas descartadas\"\n                }\n            }]\n        }\n    };\n}\n\nfunction PerdidosEnElTiempoYEnElEspacio(): IScenarioSpec {\n    const EXTRADIMENSIONAL_LOCATIONS=\"Extradimensional locations\";\n    const SHROUD=\"Shroud of your location\"\n    return {\n        name: \"Lost in Time and Space\",\n        translations: {\n            \"es\": \"Perdidos en el tiempo y en el espacio\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -tokenBag.context[EXTRADIMENSIONAL_LOCATIONS]},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (tokenBag) => -3},\n            {name: \"Antiguo\", effect: (tokenBag) => -tokenBag.context[SHROUD]},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: EXTRADIMENSIONAL_LOCATIONS,\n                description: \"Extradimensional locations in play\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Lugares Extradimensionales\"\n                }\n            },{\n                name: SHROUD,\n                description: \"Shroud value of your location\",\n                type: \"number\",\n                initialValue: 2,\n                translations: {\n                    \"es\": \"Velo de tu lugar\"\n                }\n            }]\n        }\n    };\n}\n\nexport function buildElLegadoDeDunwichCampaignSpec(): ICampaignSpec {\n    return {\n        id: \"TheDunwichLegacy\",\n        name: \"The Dunwich Legacy\",\n        scenarios: [\n            ActividadExtracurricular(), LaCasaSiempreGana(), ElMuseoMiskatonic(), ElEssexCountyExpress(),\n            SangreEnElAltar(), InvisiblesYSinDimension(), DondeAguardaLaPerdicion(), PerdidosEnElTiempoYEnElEspacio()\n        ],\n        bagSpecsByLevel: {\n            easy: easy(),\n            normal: normal(),\n            hard: hard(),\n            expert: expert(),\n        },\n        translations: {\n            \"es\": \"El legado de Dunwich\"\n        }\n    }\n}","import {\n    buildBagSpec, commonTokenEffectSpec,\n    FALLO_AUTOMATICO,\n    ScenarioEffectSpecs,\n    seal,\n    tokenAverage,\n    TokenBag,\n    TokenBagSpec,\n    tokenSpecDef\n} from \"./Token\";\nimport {ICampaignSpec} from \"./Campaign\";\nimport {IScenarioSpec} from \"./Scenario\";\n\n//TODO\nfunction easy(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 2),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Lápida\"),\n        FALLO_AUTOMATICO\n    );\n}\nfunction normal(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 1),\n        tokenSpecDef(0, 2),\n        tokenSpecDef(-1, 3),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(0, 2, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Lápida\"),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 2, true, \"Antiguo\"),\n        FALLO_AUTOMATICO\n    );\n}\n\n//TODO\nfunction hard(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 2),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Lápida\"),\n        FALLO_AUTOMATICO\n    );\n}\n\n//TODO\nfunction expert(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 1),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-4, 2),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(-6, 1),\n        tokenSpecDef(-8, 1),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Lápida\"),\n        FALLO_AUTOMATICO\n    );\n}\n\n\n\nfunction ElPozoDeLaDesesperacion(): IScenarioSpec {\n    const PARTIALLY_FLOODED=\"Partially flooded location\";\n    const FLOODED=\"Fully flooded location\";\n\n    function floodedModifier(tokenBag: TokenBag): number {\n        return tokenBag.context[FLOODED] as boolean ? -3 :\n            (tokenBag.context[PARTIALLY_FLOODED] as boolean ? -2 : -1);\n    }\n\n    return {\n        name: \"The Pit of Despair\",\n        translations: {\n            \"es\": \"El pozo de la desesperación\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"elderSign\", effect: (tokenBag) => tokenBag.character.elderSignEffect(tokenBag)},\n            {name: \"Calavera\", effect: (tokenBag) => floodedModifier(tokenBag) },\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (_) => -2},\n            {name: \"Antiguo\", effect: (_) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: PARTIALLY_FLOODED,\n                description: \"Your location is partially flooded\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Lugar parcialmente inundado\"\n                }\n            }, {\n                name: FLOODED,\n                description: \"Your location is flooded\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Lugar inundado\"\n                }\n            }\n            ]\n        }\n    };\n}\n\n\nexport function buildConspiraciondeInnsmouthCampaignSpec(): ICampaignSpec {\n    return {\n        id: \"InnsmouthConspiracy\",\n        name: \"The Innsmouth Conspiracy\",\n        scenarios: [\n            ElPozoDeLaDesesperacion()\n        ],\n        bagSpecsByLevel: {\n            easy: easy(),\n            normal: normal(),\n            hard: hard(),\n            expert: expert(),\n        },\n        translations: {\n            \"es\": \"La conspiración de Innsmouth\"\n        }\n    }\n}\n","import {ICampaignSpec} from \"./Campaign\";\nimport {\n    buildBagSpec,\n    commonTokenEffectSpec,\n    FALLO_AUTOMATICO,\n    seal,\n    tokenAverage,\n    TokenBagSpec,\n    tokenSpecDef\n} from \"./Token\";\nimport {IScenarioSpec} from \"./Scenario\";\n\nfunction easy(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 2),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 3),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        FALLO_AUTOMATICO\n    );\n}\nexport function normal(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 1),\n        tokenSpecDef(0, 2),\n        tokenSpecDef(-1, 3),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction hard (): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction expert (): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 1),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 2),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(-6, 1),\n        tokenSpecDef(-8, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction SeCierraElTelon(): IScenarioSpec {\n    const HORROR_ON_YOU=\"Horror on you\"\n    return {\n        name: \"Curtain Call\",\n        translations: {\n            \"es\": \"Se cierra el telón\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => tokenBag.context[HORROR_ON_YOU] >= 3 ? -3 : -1},\n            {name: \"Sectario\", effect: (tokenBag) => -4},\n            {name: \"Antiguo\", effect: (tokenBag) => -4},\n            {name: \"Lápida\", effect: (tokenBag) => -4},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: HORROR_ON_YOU,\n                description: \"Horror on you\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Horror que tienes\"\n                }\n            }\n            ]\n        }\n    }\n}\n\nfunction ElUltimoRey(): IScenarioSpec {\n    const SHROUD_OF_YOUR_LOCATION=\"Shroud of your location\"\n    return {\n        name: \"The Last King\",\n        translations: {\n            \"es\": \"El último rey\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Calavera\"))},\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (tokenBag) => -4},\n            {name: \"Antiguo\", effect: (tokenBag) => -tokenBag.context[SHROUD_OF_YOUR_LOCATION]},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: SHROUD_OF_YOUR_LOCATION,\n                description: \"Shroud of your location\",\n                type: \"number\",\n                initialValue: 1,\n                translations: {\n                    \"es\": \"Velo de tu lugar\"\n                }\n            }\n            ]\n        }\n    }\n}\n\nexport function EcosDelPasado(): IScenarioSpec {\n    const HIGHEST_DOOM = \"Highest doom\";\n    return {\n        name: \"Echoes of the Past\",\n        translations: {\n            \"es\": \"Ecos del pasado\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -tokenBag.context[HIGHEST_DOOM]},\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (tokenBag) => -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: HIGHEST_DOOM,\n                description: \"Highest doom on an enemy\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Mayor perdición en un enemigo\"\n                }\n            }\n            ]\n        }\n    }\n}\n\nexport function ElJuramentoInconfesable(): IScenarioSpec {\n    const HORROR_ON_YOU = \"Horror on you\";\n    const BASE_SHROUD = \"Base shroud of your location\";\n    const CHOOSE_AN_ENEMY = \"Randomly choose an enemy and place it beneath the act\"\n    return {\n        name: \"The Unspeakable Oath\",\n        translations: {\n            \"es\": \"El juramento inconfesable\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -1},\n            {name: \"Sectario\", effect: (tokenBag) => -tokenBag.context[HORROR_ON_YOU]},\n            {name: \"Lápida\", effect: (tokenBag) => -tokenBag.context[BASE_SHROUD]},\n            {name: \"Antiguo\", effect: (tokenBag) => tokenBag.context[CHOOSE_AN_ENEMY] ? 0 : -99},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: HORROR_ON_YOU,\n                description: \"Amount of horror on you\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Horror que tengas\"\n                }\n            }, {\n                name: BASE_SHROUD,\n                description: \"Base shroud of your location\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Valor de velo básico de tu lugar\"\n                }\n            }, {\n                name: CHOOSE_AN_ENEMY,\n                description: \"Randomly choose an enemy from among the set-aside Monsters and place it beneath the act\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Elige un monstruo al azar y colócalo bajo el plan\"\n                }\n            }\n            ]\n        }\n    }\n}\n\nexport function ElFantasmaDeLaVerdad(): IScenarioSpec {\n    const DOON_IN_PLAY = \"Doom in play\";\n    return {\n        name: \"A Phantom of Truth\",\n        translations: {\n            \"es\": \"El fantasma de la verdad\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -Math.min(5, tokenBag.context[DOON_IN_PLAY] as number)},\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (tokenBag) => -3},\n            {name: \"Antiguo\", effect: (tokenBag) => -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: DOON_IN_PLAY,\n                description: \"Doom in play (Max. 5)\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Perdición en juego (Max. 5)\"\n                }\n            }\n            ]\n        }\n    }\n}\n\nexport function LaMascaraPalida(): IScenarioSpec {\n    const LOCATIONS_AWAY = \"Locations away from the start\";\n    return {\n        name: \"The Pallid Mask\",\n        translations: {\n            \"es\": \"La máscara pálida\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -Math.min(5, tokenBag.context[LOCATIONS_AWAY] as number)},\n            {name: \"Sectario\", effect: (tokenBag) => -2},\n            {name: \"Lápida\", effect: (tokenBag) => -2},\n            {name: \"Antiguo\", effect: (tokenBag) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: LOCATIONS_AWAY,\n                description: \"Locations away from the starting location (Max. 5)\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Lugares de distancia al inicial (Max. 5)\"\n                }\n            }\n            ]\n        }\n    }\n}\n\nexport function SurgenEstrellasNegras(): IScenarioSpec {\n    const HIGHEST_AMOUNT_OF_DOOM = \"Highest amount of doom on an agenda\";\n    const ATTACK_EVASION_DOOM = \"Attack or evasion against an enemy with doom\";\n    return {\n        name: \"Black Stars Rise\",\n        translations: {\n            \"es\": \"Surgen estrellas negras\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -tokenBag.context[HIGHEST_AMOUNT_OF_DOOM] as number},\n            {name: \"Sectario\", effect: (tokenBag) => (tokenBag.context[ATTACK_EVASION_DOOM] as boolean) ? -99 : tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Lápida\"))},\n            {name: \"Antiguo\", effect: (tokenBag) => -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: HIGHEST_AMOUNT_OF_DOOM,\n                description: \"Highest amount of doom in an agenda\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Máxima cantidad de perdición en un plan\"\n                }\n            }, {\n                name: ATTACK_EVASION_DOOM,\n                description: \"Token revealed during an attack or evasion against an enemy with doom on it\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Ataque o evasión contra un enemigo con perdición\"\n                }\n            }\n            ]\n        }\n    }\n}\n\nexport function PenumbrosaCarcosa(): IScenarioSpec {\n    const NO_SANITY_REMAINING = \"No sanity remaining\";\n    return {\n        name: \"Dim Carcosa\",\n        translations: {\n            \"es\": \"Penumbrosa Carcosa\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => tokenBag.context[NO_SANITY_REMAINING] as boolean ? -4 : -2},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (tokenBag) => -3},\n            {name: \"Antiguo\", effect: (tokenBag) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: NO_SANITY_REMAINING,\n                description: \"You have no sanity remaining\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"No te queda cordura\"\n                }\n            }\n            ]\n        }\n    }\n}\nexport function buildCaminoACarcosaCampaignSpec(): ICampaignSpec {\n    return {\n        id: \"PathToCarcosa\",\n        name: \"Path to Carcosa\",\n        scenarios: [\n            SeCierraElTelon(), ElUltimoRey(), EcosDelPasado(), ElJuramentoInconfesable(), ElFantasmaDeLaVerdad(),\n            LaMascaraPalida(), SurgenEstrellasNegras(), PenumbrosaCarcosa()\n        ],\n        bagSpecsByLevel: {\n            easy: easy(),\n            normal: normal(),\n            hard: hard(),\n            expert: expert(),\n        },\n        translations: {\n            \"es\": \"El camino a Carcosa\"\n        }\n    }\n}","import {IScenarioSpec} from \"./Scenario\";\nimport {addTokens, TokenBagSpec, TokenSpec} from \"./Token\";\nimport {AHCharacter} from \"./AHCharacter\";\nimport {buildElCirculoRotoCampaignSpec} from \"./ElCirculoRoto\";\nimport {Translation} from \"../Utils\";\nimport {buildLaEraOlvidadaCampaignSpec} from \"./LaEraOlvidada\";\nimport {buildElLegadoDeDunwichCampaignSpec} from \"./ElLegadoDeDunwich\";\nimport {buildLosDevoradoresACampaignSpec, buildLosDevoradoresBCampaignSpec} from \"./LosDevoradoresDeSuenos\";\nimport {buildConspiraciondeInnsmouthCampaignSpec} from \"./LaConspiracionDeInnsmouth\";\nimport {buildCaminoACarcosaCampaignSpec} from \"./CaminoACarcosa\";\n\nexport type AHLevel = \"easy\" | \"normal\" | \"hard\" | \"expert\";\nexport const AHLevels = [\"easy\" , \"normal\" , \"hard\" , \"expert\"]\ntype IBagSpecByLevel = {\n    [key in AHLevel]: TokenBagSpec;\n};\n\nexport interface ICampaignSpec {\n    id: string;\n    name: string;\n    scenarios: IScenarioSpec[];\n    bagSpecsByLevel: IBagSpecByLevel;\n    translations: Translation;\n}\n\ninterface ICampaigns {\n    [key: string]: ICampaignSpec\n}\nexport const Campaigns: ICampaigns = {\n    TheCircleUndone: buildElCirculoRotoCampaignSpec(),\n    TheForgottenAge: buildLaEraOlvidadaCampaignSpec(),\n    TheDunwichLegacy: buildElLegadoDeDunwichCampaignSpec(),\n    TheDreamEatersA: buildLosDevoradoresACampaignSpec(),\n    TheDreamEatersB: buildLosDevoradoresBCampaignSpec(),\n    InnsmouthConspiracy: buildConspiraciondeInnsmouthCampaignSpec(),\n    PathToCarcosa: buildCaminoACarcosaCampaignSpec(),\n}\n\nexport const campaignTranslations = Object.values(Campaigns).reduce<any>((allTrans, campaign) => {\n    const thisTranslations = campaign.translations;\n    Object.keys(thisTranslations).forEach(lang => {\n        if (allTrans[lang] === undefined) {\n            allTrans[lang] = {}\n        }\n        allTrans[lang][campaign.name] = thisTranslations[lang];\n    });\n    campaign.scenarios.forEach(scenario =>  {\n        Object.keys(scenario.translations).forEach(scenarioLang => {\n            if (allTrans[scenarioLang] === undefined) {\n                allTrans[scenarioLang] = {}\n            }\n            allTrans[scenarioLang][scenario.name] = scenario.translations[scenarioLang]\n        });\n        scenario.contextSpec.valuesSpec.forEach(valueSpec => {\n            Object.keys(valueSpec.translations).forEach(valueSpecLang => {\n                if (allTrans[valueSpecLang] === undefined) {\n                    allTrans[valueSpecLang] = {}\n                }\n                allTrans[valueSpecLang][valueSpec.name] = valueSpec.translations[valueSpecLang];\n            });\n\n        })\n    });\n    return allTrans;\n}, {});\n\ninterface ICampaign {\n}\n\nexport class Campaign implements ICampaign {\n    public currentScenario = 0;\n\n    constructor(public name: string,\n                public campaignSpec: ICampaignSpec,\n                public characters: AHCharacter[],\n                public currentBagSpec: TokenBagSpec,\n                currentScenario = 0) {\n        this.startCampaign(currentScenario);\n    }\n\n    public static start(campaignSpec: ICampaignSpec, characters: AHCharacter[], level: AHLevel): Campaign {\n        return new Campaign(campaignSpec.name, campaignSpec, characters, campaignSpec.bagSpecsByLevel[level]);\n    }\n\n\n    startCampaign(scenarioNum = 0) {\n        this.currentScenario = scenarioNum;\n        let scenarioIndex = 0;\n        while (scenarioIndex <= scenarioNum) {\n            this.currentScenario = scenarioIndex;\n            scenarioIndex++;\n        }\n    }\n\n    getScenarioSpec() {\n        return this.campaignSpec.scenarios[this.currentScenario];\n    }\n\n    addTokensToBagSpec(...tokens: TokenSpec[]) {\n        this.currentBagSpec = addTokens(this.currentBagSpec, ...tokens);\n    }\n\n    nextScenario() {\n        if ((this.currentScenario + 1 ) < this.campaignSpec.scenarios.length) {\n            this.currentScenario++;\n            // console.log(\"Current scenario index\", this.currentScenario, \"name\", this.campaignSpec.scenarios[this.currentScenario].name);\n            if (this.currentScenario >= this.campaignSpec.scenarios.length) {\n                // TODO: Modify current bag spec depending on resolution or preparation of new scenario\n                // advanceScenario\n            }\n        }\n        return this.getScenarioSpec();\n    }\n\n    // Returns to the previous scenario with the bag as it was\n    prevScenario() {\n        if (this.currentScenario  > 0) {\n            this.currentScenario--;\n        }\n        return this.getScenarioSpec();\n    }\n}\n","import {\n    buildBagSpec,\n    commonTokenEffectSpec,\n    FALLO_AUTOMATICO,\n    seal,\n    tokenAverage,\n    TokenBagSpec,\n    tokenSpecDef\n} from \"./Token\";\nimport {ICampaignSpec} from \"./Campaign\";\nimport {IScenarioSpec} from \"./Scenario\";\n\nfunction easyA(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 2),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Lápida\"),\n        FALLO_AUTOMATICO\n    );\n}\nfunction normalA(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 1),\n        tokenSpecDef(0, 2),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Lápida\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction hardA(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 2),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Lápida\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction expertA(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 1),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-4, 2),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(-6, 1),\n        tokenSpecDef(-8, 1),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Lápida\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction easyB(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 2),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 3),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Antiguo\"),\n        FALLO_AUTOMATICO\n    );\n}\nfunction normalB(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 1),\n        tokenSpecDef(0, 2),\n        tokenSpecDef(-1, 3),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Antiguo\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction hardB(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 4),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Antiguo\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction expertB(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 1),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 2),\n        tokenSpecDef(-4, 2),\n        tokenSpecDef(-5, 1),\n        tokenSpecDef(-6, 1),\n        tokenSpecDef(-8, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        tokenSpecDef(0, 1, true, \"Sectario\"),\n        tokenSpecDef(0, 2, true, \"Antiguo\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction MásAlláDeLasPuertasDelSueño(): IScenarioSpec {\n    const CARDS_IN_YOUR_HAND=\"Cards in your hand\";\n    const REVEALED_WOODS=\"Revealed Woods locations\";\n    return {\n        name: \"Beyond the Gates of Sleep\",\n        translations: {\n            \"es\": \"Más allá de las puertas del sueño\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => Math.ceil(-tokenBag.context[CARDS_IN_YOUR_HAND] / 2)},\n            {name: \"Sectario\", effect: (tokenBag) => -tokenBag.context[REVEALED_WOODS]},\n            {name: \"Lápida\", effect: (_) => -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: CARDS_IN_YOUR_HAND,\n                description: \"Number of cards in your hand\",\n                type: \"number\",\n                initialValue: 5,\n                translations: {\n                    \"es\": \"Cartas en tu mano\"\n                }\n            }, {\n                name: REVEALED_WOODS,\n                description: \"Number of revealed Enchanted Woods locations\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Número de bosques encantados revelados\"\n                }\n            }\n            ]\n        }\n    };\n}\n\nfunction LaBúsquedaDeKadath(): IScenarioSpec {\n    const NUMBER_OF_SIGNS_OF_GOD=\"Number of signs of gods\";\n    return {\n        name: \"The Search for Kadath\",\n        translations: {\n            \"es\": \"La búsqueda de Kadath\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => tokenBag.context[NUMBER_OF_SIGNS_OF_GOD] as number},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (_) => -2},\n            {name: \"Antiguo\", effect: (_) => +2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: NUMBER_OF_SIGNS_OF_GOD,\n                description: \"Number of signs of gods uncovered\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Número de señales de los dioses\"\n                }\n            }\n            ]\n        }\n    };\n}\nfunction ElLadoOscuroDeLaLuna(): IScenarioSpec {\n    const ALARM_LEVEL=\"Alarm level\";\n    return {\n        name: \"Dark Side of the Moon\",\n        translations: {\n            \"es\": \"El lado oscuro de la luna\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -Math.ceil(tokenBag.context[ALARM_LEVEL] as number / 2)},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (_) => -1},\n            {name: \"Antiguo\", effect: (_) => +1},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: ALARM_LEVEL,\n                description: \"Alarm level\",\n                type: \"number\",\n                initialValue: 1,\n                translations: {\n                    \"es\": \"Nivel de alarma\"\n                }\n            }\n            ]\n        }\n    };\n}\n\nfunction DondeMoranLosDioses(): IScenarioSpec {\n    const CURRENT_ACT=\"Current act\";\n    return {\n        name: \"Where Gods Dwell\",\n        translations: {\n            \"es\": \"Donde moran los dioses\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -tokenBag.context[CURRENT_ACT] as number},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (_) => -4},\n            {name: \"Antiguo\", effect: (_) => 0},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: CURRENT_ACT,\n                description: \"Number of the current act\",\n                type: \"number\",\n                initialValue: 1,\n                translations: {\n                    \"es\": \"Número del acto en curso\"\n                }\n            }\n            ]\n        }\n    };\n}\n// ----- Campaign B\n\n\n\nfunction PesadillaConsciente(): IScenarioSpec {\n    const ENGANGED_WITH_A_STAFF = \"Engaged with a staff enemy\";\n    const NUMBER_OF_INFESTED = \"Number of infested locations\";\n    return {\n        name: \"Waking Nightmare\",\n        translations: {\n            \"es\": \"Punto sin retorno\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => (tokenBag.context[ENGANGED_WITH_A_STAFF] as boolean) ? -3 : -1},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Antiguo\", effect: (tokenBag) => -tokenBag.context[NUMBER_OF_INFESTED]},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: ENGANGED_WITH_A_STAFF,\n                description: \"Enganged with a staff enemy\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Enfrentado a un enemigo personal\"\n                }\n            }, {\n                name: NUMBER_OF_INFESTED,\n                description: \"Number of infested locations\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Número de localizaciones infestadas\"\n                }\n            }\n            ]\n        }\n    };\n}\n\nfunction MilFormasDeHorror(): IScenarioSpec {\n    const GRAVEYARD_LOCATION = \"At a graveyard location\";\n    return {\n        name: \"A Thousand Shapes of Horror\",\n        translations: {\n            \"es\": \"Mil formas de horror\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => tokenBag.context[GRAVEYARD_LOCATION] ? -3 : -1},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (_) => +2},\n            {name: \"Antiguo\", effect: (_) => -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: GRAVEYARD_LOCATION,\n                description: \"You are at a graveyard location\",\n                type: \"boolean\",\n                initialValue: true,\n                translations: {\n                    \"es\": \"En una localización cementerio\"\n                }\n            }\n            ]\n        }\n    };\n}\n\nfunction PuntoSinRetorno(): IScenarioSpec {\n    const DAMAGE_ON_SCENARIO = \"Damage on scenario card\";\n    return {\n        name: \"Point of No Return\",\n        translations: {\n            \"es\": \"Punto sin retorno\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -tokenBag.context[DAMAGE_ON_SCENARIO]},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (_) => +1},\n            {name: \"Antiguo\", effect: (_) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: DAMAGE_ON_SCENARIO,\n                description: \"Damage on this card\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Daño en carta de escenario\"\n                }\n            }\n            ]\n        }\n    };\n}\n\nfunction TejedoraDelCosmos(): IScenarioSpec {\n    const HIGHEST_DOOM = \"Highest doom on a location\";\n    return {\n        name: \"Weaver of the Cosmos\",\n        translations: {\n            \"es\": \"Tejedora del cosmos\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => -tokenBag.context[HIGHEST_DOOM]},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: (_) => 0},\n            {name: \"Antiguo\", effect: (_) => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: HIGHEST_DOOM,\n                description: \"Highest amount of doom on a location in play\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Mayor perdición en un lugar\"\n                }\n            }\n            ]\n        }\n    };\n}\n\nexport function buildLosDevoradoresACampaignSpec(): ICampaignSpec {\n    return {\n        id: \"TheDreamEatersA\",\n        name: \"The Dream-Eaters A\",\n        scenarios: [\n            MásAlláDeLasPuertasDelSueño(), LaBúsquedaDeKadath(), ElLadoOscuroDeLaLuna(), DondeMoranLosDioses()\n        ],\n        bagSpecsByLevel: {\n            easy: easyA(),\n            normal: normalA(),\n            hard: hardA(),\n            expert: expertA(),\n        },\n        translations: {\n            \"es\": \"Los devoradores de sueños A\"\n        }\n    }\n}\n\nexport function buildLosDevoradoresBCampaignSpec(): ICampaignSpec {\n    return {\n        id: \"TheDreamEatersB\",\n        name: \"The Dream-Eaters B\",\n        scenarios: [\n            PesadillaConsciente(), MilFormasDeHorror(), PuntoSinRetorno(),TejedoraDelCosmos()\n        ],\n        bagSpecsByLevel: {\n            easy: easyB(),\n            normal: normalB(),\n            hard: hardB(),\n            expert: expertB(),\n        },\n        translations: {\n            \"es\": \"Los devoradores de sueños B\"\n        }\n    }\n}","import {\n    addTokens,\n    buildBagSpec, commonTokenEffectSpec,\n    FALLO_AUTOMATICO,\n    removeToken, seal,\n    tokenAverage, TokenBag,\n    TokenBagSpec,\n    tokenSpecDef\n} from \"./Token\";\nimport {AHLevel, Campaign, ICampaignSpec} from \"./Campaign\";\nimport {IScenarioSpec} from \"./Scenario\";\nimport {AHCharacter, AHCharacters} from \"./AHCharacter\";\n\n\nfunction easy(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 2),\n        tokenSpecDef(0, 3),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,1),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        FALLO_AUTOMATICO\n    );\n}\nexport function normal(): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(1, 1),\n        tokenSpecDef(0, 2),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        FALLO_AUTOMATICO\n        );\n}\nfunction hard (): TokenBagSpec {\n    return addTokens(\n            removeToken(normal(), \"1\"),\n            tokenSpecDef(-5, 1),\n    )\n}\n\nfunction expert (): TokenBagSpec {\n    return buildBagSpec(\n        tokenSpecDef(1, 1, false, \"elderSign\"),\n        tokenSpecDef(0, 1),\n        tokenSpecDef(-1, 2),\n        tokenSpecDef(-2,2),\n        tokenSpecDef(-3, 1),\n        tokenSpecDef(-4, 1),\n        tokenSpecDef(-6, 1),\n        tokenSpecDef(-8, 1),\n        tokenSpecDef(0, 2, true, \"Calavera\"),\n        FALLO_AUTOMATICO\n    );\n}\n\nfunction Prologo(): IScenarioSpec {\n    return {\n        name: \"Disappearance at the Twilight Estate\",\n        translations: {\n            \"es\": \"Desaparición en la finca del crepúsculo\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: () => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: []\n        }\n    };\n}\n\nfunction LaHoraBruja(): IScenarioSpec {\n    return {\n        name: \"The Witching Hour\",\n        translations: {\n            \"es\": \"La hora bruja\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            { name: \"Calavera\", effect: () => -1 },\n            { name: \"Lápida\", effect: () => -3 },\n            { name: \"Antiguo\", effect: () => -3 },\n        ]),\n        contextSpec: {\n            valuesSpec: []\n        }\n    }\n}\n\nfunction ALasPuertasDeLaMuerte(): IScenarioSpec {\n    const HAUNTED_LOCATION = \"Haunted location\";\n    return {\n        name: \"At Death's Doorstep\",\n        translations: {\n            \"es\": \"A las puertas de la muerte\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            { name: \"Calavera\", effect: (tokenBag) => tokenBag.context[HAUNTED_LOCATION] ? -3 : -1 },\n            { name: \"Lápida\", effect: () => -2 },\n            { name: \"Antiguo\", effect: () => -2 },\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: HAUNTED_LOCATION,\n                description: \"Haunted location\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Lugar embrujado\"\n                }\n            }]\n        }\n    }\n}\n\nfunction ElNombreSecreto(): IScenarioSpec {\n    const EXTRADIMENSIONAL_LOCATION = \"Extradimensional location\";\n    return {\n        name: \"The Secret Name\",\n        translations: {\n            \"es\": \"El nombre secreto\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            { name: \"Calavera\", effect: (tokenBag) => tokenBag.context[EXTRADIMENSIONAL_LOCATION] ? -3 : -1 },\n            { name: \"Sectario\", effect: tokenBag => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            { name: \"Lápida\", effect: () => -2 },\n            { name: \"Antiguo\", effect: () => -3 },\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: EXTRADIMENSIONAL_LOCATION,\n                description: \"Extradimensional location\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Lugar Extradimensional\"\n                }\n            }]\n        }\n    }\n}\n\nfunction LaPagaDelPecado(): IScenarioSpec {\n    const UNFINISHED_BUSINESS = \"Unfinished business\";\n    const FIGHTING_EVADING_HERETIC = \"Fighting/evading Heretic\";\n    return {\n        name: \"The Wages of Sin\",\n        translations: {\n            \"es\": \"La paga del pecado\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => 0 - (tokenBag.context[UNFINISHED_BUSINESS] as number)},\n            {name: \"Sectario\", effect: (tokenBag) => tokenBag.context[FIGHTING_EVADING_HERETIC] ? -4 : -3 },\n            {name: \"Lápida\", effect: () => -3},\n            {name: \"Antiguo\", effect: () => -2},\n        ]),\n        contextSpec: {\n            valuesSpec: [\n                {\n                    name: UNFINISHED_BUSINESS,\n                    description: \"Unfinished business\",\n                    type: \"number\",\n                    initialValue: 0,\n                    translations: {\n                        \"es\": \"Asuntos inconclusos\",\n                    }\n                },\n                {\n                    name: FIGHTING_EVADING_HERETIC,\n                    description: \"Fighting/evading Heretic\",\n                    type: \"boolean\",\n                    initialValue: false,\n                    translations: {\n                        \"es\": \"Atacando/Evitando Hereje\"\n                    }\n                }\n            ]\n        }\n    };\n}\n\nfunction PorElBienComun(): IScenarioSpec {\n    const MAXIMA_PERDICION = \"Max Doom\";\n    return {\n        name: \"For the Greater Good\",\n        translations: {\n            \"es\": \"Por el bien común\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => 0 - (tokenBag.context[MAXIMA_PERDICION] as number)},\n            {name: \"Sectario\", effect: tokenBag => tokenAverage(seal(tokenBag, \"Sectario\")) - 2},\n            {name: \"Lápida\", effect: () => -3},\n            {name: \"Antiguo\", effect: () => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: MAXIMA_PERDICION,\n                description: \"Highest number of doom on a Cultist\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Máxima perdición\"\n                }\n            }]\n        }\n    };\n}\n\nfunction UnionYDesilusion(): IScenarioSpec {\n    const ACCION_CIRCULO = \"Circle action\";\n    return {\n        name: \"Union and Disillusion\",\n        translations: {\n            \"es\": \"Unión y desilusión\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) =>\n                    tokenBag.context[ACCION_CIRCULO] ? tokenAverage(seal(tokenBag, \"Calavera\")) - 2 : -2},\n            {name: \"Sectario\", effect: () => -3},\n            {name: \"Lápida\", effect: () => -3},\n            {name: \"Antiguo\", effect: () => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: ACCION_CIRCULO,\n                description: \"This skill test is a circle action\",\n                type: \"boolean\",\n                initialValue: false,\n                translations: {\n                    \"es\": \"Acción círculo\"\n                }\n            }]\n        }\n    };\n}\n\nfunction EnLasGarrasDelCaos(): IScenarioSpec {\n    const PERDICION_Y_BRECHA = \"Doom and breaches on your location\";\n    const getPerdicionYBrecha = (tokenBag: TokenBag) => {\n        return tokenBag.context[PERDICION_Y_BRECHA] as number;\n    }\n\n    return {\n        name: \"In the Clutches of Chaos\",\n        translations: {\n          \"es\": \"En las garras del caos\",\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => 0 - getPerdicionYBrecha(tokenBag)},\n            {name: \"Sectario\", effect: (tokenBag) => {\n                //Creates a new bag and a new context for this calculation\n                    const potentialBag = seal(tokenBag, \"Sectario\");\n                    potentialBag.context = {\n                        [PERDICION_Y_BRECHA]: Math.max(3, getPerdicionYBrecha(tokenBag) + 1),\n                    }\n                    return tokenAverage(potentialBag);\n                }},\n            {name: \"Lápida\", effect: () => -2},\n            {name: \"Antiguo\", effect: () => -3},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: PERDICION_Y_BRECHA,\n                description: \"Total amount of doom and breaches on your location\",\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Perdición y brecha en tu lugar\"\n                }\n            }]\n        }\n    };\n}\n\nfunction AnteElTronoNegro(): IScenarioSpec {\n    const PERDICION_EN_AZATHOTH = \"Doom on Azathoth\";\n    const getHalfDoomInAzathot = (tokenBag: TokenBag) => {\n        return Math.ceil((tokenBag.context[PERDICION_EN_AZATHOTH] as number) / 2);\n    }\n\n    return {\n        name: \"Before the Black Throne\",\n        translations: {\n            \"es\": \"Ante el trono negro\"\n        },\n        scenarioEffectSpec: commonTokenEffectSpec().concat([\n            {name: \"Calavera\", effect: (tokenBag) => 0 - Math.max(2, getHalfDoomInAzathot(tokenBag))},\n            {name: \"Sectario\", effect: (tokenBag) => tokenAverage(seal(tokenBag, \"Sectario\"))},\n            {name: \"Lápida\", effect: () => -2},\n            {name: \"Antiguo\", effect: () => -4},\n        ]),\n        contextSpec: {\n            valuesSpec: [{\n                name: PERDICION_EN_AZATHOTH,\n                description: PERDICION_EN_AZATHOTH,\n                type: \"number\",\n                initialValue: 0,\n                translations: {\n                    \"es\": \"Perdición en Azathoth\"\n                }\n            }]\n        }\n    };\n}\n\nexport function buildElCirculoRotoCampaignSpec(): ICampaignSpec {\n    return {\n        id: \"TheCircleUndone\",\n        name: \"The Circle Undone\",\n        scenarios: [\n            Prologo(),\n            LaHoraBruja(), ALasPuertasDeLaMuerte(), ElNombreSecreto(), LaPagaDelPecado(),\n            PorElBienComun(), UnionYDesilusion(), EnLasGarrasDelCaos(), AnteElTronoNegro()\n        ],\n        bagSpecsByLevel: {\n            easy: easy(),\n            normal: normal(),\n            hard: hard(),\n            expert: expert(),\n        },\n        translations: {\n            \"es\": \"El círculo roto\"\n        }\n    }\n}\n\nexport function startElCirculoRoto(characters: AHCharacter[], level: AHLevel) {\n    return Campaign.start(buildElCirculoRotoCampaignSpec(), characters, level);\n}\n\nexport function startAlvaroElCirculoRotoLPDP() {\n    const campaign = startElCirculoRoto([\n        AHCharacters[\"JoeDiamond\"], AHCharacters[\"DianaStanley\"],\n        // {name: \"Joe Diamond\", shortName: \"Joe\", elderSignEffect: () => 1},\n        // {name: \"Diana Stanley\", shortName: \"Diana\", elderSignEffect: () => 2},\n    ], \"normal\");\n    campaign.addTokensToBagSpec(\n        tokenSpecDef(0, 2, true, \"Lápida\"), // <- La hora bruja: Los inv han aceptado su destino\n        tokenSpecDef(0, 1, true, \"Sectario\"), // <- El precio del progreso, unirme a la logia\n        tokenSpecDef(0, 1, true, \"Calavera\"), // <- El nombre secreto, coger el Libro Negro\n        // tokenSpecDef(0, 1, true, \"Antiguo\"),\n        // tokenSpecDef(-5, 1, false),\n    );\n    campaign.startCampaign(0);\n    return campaign;\n}","import {CombinedState, combineReducers, Reducer} from \"redux\";\nimport {Campaign} from \"./tok/Campaign\";\nimport {initContext, IScenarioSpec} from \"./tok/Scenario\";\nimport {\n    addTokens,\n    incDecContextNatural,\n    removeToken,\n    ScenarioContext,\n    TokenBagSpec\n} from \"./tok/Token\";\nimport {startAlvaroElCirculoRotoLPDP} from \"./tok/ElCirculoRoto\";\nimport {\n    ADD_TOKEN,\n    CHANGE_CHARACTER,\n    CHANGE_SCENARIO,\n    CHANGE_SKILL,\n    CHANGE_TEST,\n    IAppAction, ICampaignSelectAction,\n    ICharacterAction,\n    IContextAction,\n    IIncDecAction,\n    INC_DEC_CONTEXT_VALUE,\n    IScenarioAction, ITokenAction,\n    NEXT_SCENARIO,\n    PREV_SCENARIO, REMOVE_TOKEN, SELECT_CAMPAIGN,\n    TOGGLE_CONTEXT_VALUE\n} from \"./AppActions\";\nimport {AppState} from \"./AppState\";\nimport {SkillTest} from \"./tok/SkillTest\";\nimport {AHCharacter} from \"./tok/AHCharacter\";\nimport {incDecNatural} from \"./Utils\";\n\n\nconst defaultCampaign = startAlvaroElCirculoRotoLPDP();\n\nconst  selectedCampaign: Reducer<Campaign, IAppAction> = (state: Campaign = defaultCampaign, action: IAppAction) => {\n    switch (action.type) {\n        case NEXT_SCENARIO:\n            state.nextScenario();\n            return state;\n        case PREV_SCENARIO:\n            state.prevScenario();\n            return state;\n        case SELECT_CAMPAIGN:\n            return (action as ICampaignSelectAction).campaign;\n        default:\n            return state;\n    }\n}\n\n\nconst firstScenario = defaultCampaign.getScenarioSpec();\nconst selectedScenario: Reducer<IScenarioSpec, IAppAction> = (state = firstScenario, action: IAppAction) => {\n    switch (action.type) {\n        case SELECT_CAMPAIGN:\n            return (action as ICampaignSelectAction).campaign.getScenarioSpec();\n        case CHANGE_SCENARIO:\n            return (action as IScenarioAction).scenarioSpec;\n        default:\n            return state;\n    }\n}\n\nconst selectedCharacter: Reducer<AHCharacter, IAppAction> = (state = defaultCampaign.characters[0], action: IAppAction) => {\n    switch (action.type) {\n        case CHANGE_CHARACTER:\n            return (action as ICharacterAction).character;\n        case SELECT_CAMPAIGN:\n            return (action as ICampaignSelectAction).campaign.characters[0];\n        default:\n            return state;\n    }\n}\nconst initialContext = initContext(firstScenario.contextSpec);\nconst gameContext: Reducer<ScenarioContext, IAppAction> = (gameContext = initialContext, action: IAppAction) => {\n    switch (action.type) {\n        case SELECT_CAMPAIGN:\n            return initContext((action as ICampaignSelectAction).campaign.getScenarioSpec().contextSpec);\n        case CHANGE_SCENARIO:\n            return initContext((action as IScenarioAction).scenarioSpec.contextSpec);\n        case INC_DEC_CONTEXT_VALUE:\n            const contextAction = action as IContextAction & IIncDecAction;\n            const key = contextAction.key;\n            return Object.assign({}, gameContext, {\n                [key]: incDecContextNatural(gameContext, key, contextAction.incDec)\n            });\n        case TOGGLE_CONTEXT_VALUE:\n            const contextToggleAction = action as IContextAction;\n            return Object.assign({}, gameContext, {\n                [contextToggleAction.key]: !(gameContext[contextToggleAction.key] as boolean)\n            });\n        default:\n            return gameContext;\n    }\n}\n\nconst initialSkillTest = {skill: 4, test: 2} as SkillTest;\nconst skillTest: Reducer<SkillTest, IAppAction> = (state = initialSkillTest, action) => {\n    const skillTestAction = action as IIncDecAction;\n    switch (action.type) {\n        case CHANGE_SKILL:\n            return Object.assign({}, state, {\n                skill: incDecNatural(state.skill, skillTestAction.incDec)\n            });\n        case CHANGE_TEST:\n            return Object.assign({}, state, {\n                test: incDecNatural(state.test, skillTestAction.incDec)\n            });\n        default:\n            return state;\n\n    }\n}\n\nconst bagSpec: Reducer<TokenBagSpec, IAppAction> = (state = defaultCampaign.currentBagSpec, action) => {\n    const tokenAction = action as ITokenAction;\n    switch (action.type) {\n        case SELECT_CAMPAIGN:\n            return (action as ICampaignSelectAction).campaign.currentBagSpec;\n        case ADD_TOKEN:\n            return addTokens(state, tokenAction.tokenSpec);\n        case REMOVE_TOKEN:\n            return removeToken(state, tokenAction.tokenSpec.name);\n        default:\n            return state;\n    }\n}\n\nexport const appReducers: Reducer<CombinedState<AppState>, IAppAction>  = combineReducers<AppState, IAppAction>({\n    selectedCampaign,  bagSpec, selectedCharacter, selectedScenario, gameContext, skillTest\n});\n","import {createStore, Store} from \"redux\";\nimport {appReducers} from \"./AppReducers\";\nimport {IAppAction} from \"./AppActions\";\nimport {AppState} from \"./AppState\";\nimport {Campaign, Campaigns, ICampaignSpec} from \"./tok/Campaign\";\nimport {SkillTest} from \"./tok/SkillTest\";\nimport {ScenarioContext, TokenBagSpec} from \"./tok/Token\";\nimport {AHCharacters} from \"./tok/AHCharacter\";\nimport {initContext} from \"./tok/Scenario\";\nimport {startAlvaroLaEraOlvidada} from \"./tok/LaEraOlvidada\";\n\n\ninterface IStorageStage {\n    name: string;\n    campaignSpecId: string;\n    bagSpec: TokenBagSpec;\n    characters: string[];\n    currentScenario: number;\n    currentCharacter: string;\n    currentContext: ScenarioContext;\n}\nfunction loadStorageStage(): IStorageStage | undefined {\n    const storageStateString = localStorage.getItem(\"ahtok.kortsoft.net/state\");\n    return storageStateString ? JSON.parse(storageStateString) : undefined;\n}\n\n\nconst LANGUAGE_STORE_KEY = \"ahtok.kortsoft.net/lang\";\n\nexport function loadCurrentLang() {\n    const appLang = localStorage.getItem(LANGUAGE_STORE_KEY);\n    if (appLang === null) {\n        let userLang: string = navigator.language;\n        const dashPosition = userLang.indexOf(\"-\");\n        if (dashPosition > -1) {\n            userLang = userLang.substring(0, dashPosition);\n        }\n        return userLang;\n    }\n    return appLang;\n}\n\nfunction initialState():AppState {\n    function defaultCampaign() {\n        return startAlvaroLaEraOlvidada();\n    }\n    const preloadCampaign = loadStorageStage();\n    if (preloadCampaign) {\n        const campaignSpec: ICampaignSpec = Campaigns[preloadCampaign.campaignSpecId];\n        const characters = preloadCampaign.characters.map(cId => AHCharacters[cId]);\n        const campaign = new Campaign(\n            preloadCampaign.name, campaignSpec, characters,\n            preloadCampaign.bagSpec, preloadCampaign.currentScenario);\n        const character = AHCharacters[preloadCampaign.currentCharacter];\n        return {\n            selectedCampaign: campaign,\n            selectedScenario: campaign.getScenarioSpec(),\n            selectedCharacter: character,\n            skillTest: {skill: 4, test: 2} as SkillTest,\n            gameContext: preloadCampaign.currentContext,\n            bagSpec: preloadCampaign.bagSpec\n        }\n    } else {\n        const campaign = defaultCampaign();\n        const currentScenarioSpec = campaign.getScenarioSpec();\n        return {\n            selectedCampaign: campaign,\n            selectedScenario: currentScenarioSpec,\n            selectedCharacter: campaign.characters[0],\n            skillTest: {skill: 4, test: 2} as SkillTest,\n            gameContext: initContext(currentScenarioSpec.contextSpec),\n            bagSpec: campaign.currentBagSpec,\n        };\n    }\n\n}\n\nconst appState = initialState();\nexport let store: Store<AppState, IAppAction> =\n    createStore<AppState, IAppAction, {}, {}>(appReducers, appState);\n\nexport function resetStore() {\n    store = createStore<AppState, IAppAction, {}, {}>(appReducers);\n}\n\nexport function saveLang(lang: string) {\n    localStorage.setItem(LANGUAGE_STORE_KEY, lang);\n}\n\nstore.subscribe(() => {\n    const campaign = store.getState().selectedCampaign;\n    const newStorageCampaign: IStorageStage = {\n        name: campaign.name,\n        campaignSpecId: campaign.campaignSpec.id,\n        bagSpec: store.getState().bagSpec,\n        characters: campaign.characters.map(c => c.id),\n        currentScenario: campaign.currentScenario,\n        currentCharacter: store.getState().selectedCharacter.id,\n        currentContext: store.getState().gameContext\n    };\n    localStorage.setItem(\"ahtok.kortsoft.net/state\", JSON.stringify(newStorageCampaign));\n});","import {AHLevel, AHLevels, Campaign, Campaigns} from \"./tok/Campaign\";\nimport {useTranslation} from \"react-i18next\";\nimport React, {useState} from \"react\";\nimport {useModalStyles} from \"./CommonStyles\";\nimport {\n    Box,\n    Button,\n    Checkbox,\n    createStyles,\n    FormControl,\n    FormControlLabel,\n    FormGroup,\n    FormLabel,\n    InputLabel,\n    makeStyles,\n    MenuItem,\n    Select,\n    Theme,\n    Typography\n} from \"@material-ui/core\";\nimport {connect} from \"react-redux\";\nimport {AppState} from \"./AppState\";\nimport {Dispatch} from \"redux\";\nimport {selectCampaign} from \"./AppActions\";\nimport {AHCharacter, AHCharacters} from \"./tok/AHCharacter\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        formControl: {\n            margin: theme.spacing(1),\n            minWidth: 120,\n        },\n        selectEmpty: {\n            marginTop: theme.spacing(2),\n        },\n    }),\n);\ntype WizardProps = { campaignWizard: CampaignWizard, setCampaignWizard: (campaignWizard: CampaignWizard) => void }\nexport const CampaignWizardChanger = connect((_: AppState) => ({}),\n    (dispatch: Dispatch, ownProps: { close: () => void }) => ({\n        setCampaign: (campaign: Campaign) => {\n            ownProps.close();\n            dispatch(selectCampaign(campaign));\n        }\n    }))(CampaignWizardComp)\n\nfunction CampaignWizardComp({setCampaign}: { setCampaign: (campaign: Campaign) => void }) {\n    const {t} = useTranslation();\n    const [campaignWizard, setCampaignWizard] = useState({characters: []} as CampaignWizard)\n    const classes = useModalStyles();\n\n    function selectCampaignId(campaignId: string) {\n        setCampaignWizard({campaignId, characters: []})\n    }\n\n    function setCampaignFromWizard(campaignWizard: CampaignWizard) {\n\n        const campaignSpec = Campaigns[campaignWizard.campaignId!];\n        const campaign = Campaign.start(campaignSpec, campaignWizard.characters, campaignWizard.level!);\n        campaign.startCampaign(0);\n        setCampaign(campaign);\n    }\n\n    return (\n        <Box textAlign=\"center\" className={classes.paper}>\n            <Typography id=\"bag-management-title\" variant=\"h3\">{t('Create campaign')}</Typography>\n            <InputLabel style={{marginTop: \"15px\"}}>{t('Select campaign')}</InputLabel>\n            <FormControl variant=\"standard\" className={useStyles().formControl}>\n                <Select\n                    labelId=\"campaign-selector-label\"\n                    id=\"campaign-selector\"\n                    value={campaignWizard.campaignId ?? \"\"}\n                    onChange={e => selectCampaignId(e.target.value as string)}>\n                    {Object.keys(Campaigns).map(campaignId => (\n                        <MenuItem key={campaignId} value={campaignId}>{t(Campaigns[campaignId].name)}</MenuItem>\n                    ))}\n                </Select>\n            </FormControl>\n            {campaignWizard.campaignId ?\n                <WizardStep2 campaignWizard={campaignWizard} setCampaignWizard={setCampaignWizard}/> : null}\n            {campaignWizard.campaignId && campaignWizard.level && campaignWizard.characters.length > 0 ?\n                <Button onClick={() => setCampaignFromWizard(campaignWizard)}>{t('Create')}</Button> : null}\n        </Box>\n    )\n}\n\nfunction WizardStep2({campaignWizard, setCampaignWizard}: WizardProps) {\n    const {t} = useTranslation();\n\n    function selectLevel(level: AHLevel) {\n        setCampaignWizard(Object.assign({}, campaignWizard, {level}))\n    }\n\n    return (\n        <Box>\n            <InputLabel style={{marginTop: \"15px\"}}>{t('Select level')}</InputLabel>\n            <FormControl variant=\"standard\" className={useStyles().formControl}>\n                <Select\n                    labelId=\"level-selector-label\"\n                    id=\"level-selector\"\n                    value={campaignWizard.level ?? \"\"}\n                    onChange={e => selectLevel(e.target.value as AHLevel)}>\n                    {AHLevels.filter(level => level !== \"hard\" && level !== \"expert\").map(level => (\n                        <MenuItem key={level} value={level}>{t(level)}</MenuItem>\n                    ))}\n                </Select>\n                <Typography variant=\"caption\">{t(\"Hard and expert coming soon\")}</Typography>\n            </FormControl>\n            {campaignWizard.level ?\n                <WizardStep3 campaignWizard={campaignWizard} setCampaignWizard={setCampaignWizard}/> : null}\n        </Box>\n    )\n}\n\nfunction WizardStep3({campaignWizard, setCampaignWizard}: { campaignWizard: CampaignWizard, setCampaignWizard: (campaignWizard: CampaignWizard) => void }) {\n    const {t} = useTranslation();\n\n    function contains(characterId: string) {\n        return campaignWizard.characters.some(ch => ch.id === characterId);\n    }\n\n    function addCharacter(ev: React.ChangeEvent<HTMLInputElement>, checked: boolean) {\n        const character = AHCharacters[ev.target.name as string];\n        let characters;\n        if (checked) {\n            characters = campaignWizard.characters.concat(character);\n        } else {\n            characters = campaignWizard.characters.filter(ch => ch.id !== character.id);\n        }\n        setCampaignWizard(Object.assign({}, campaignWizard, {characters}));\n    }\n\n    const error = campaignWizard.characters.length > 4;\n    return (\n        <Box>\n            <FormControl error={error} component=\"fieldset\" className={useStyles().formControl}>\n                <FormLabel component=\"legend\">{t('Pick up two four characters')}</FormLabel>\n                <FormGroup>\n                    {Object.keys(AHCharacters).map(characterId => (\n                        <FormControlLabel\n                            key={characterId}\n                            control={<Checkbox checked={contains(characterId)} onChange={addCharacter}\n                                               name={characterId}/>}\n                            label={AHCharacters[characterId].name}\n                        />\n                    ))}\n                </FormGroup>\n            </FormControl>\n        </Box>\n    )\n}\n\ninterface CampaignWizard {\n    campaignId?: string;\n    level?: AHLevel;\n    characters: AHCharacter[];\n}","import {Box, IconButton, Modal, Typography} from \"@material-ui/core\";\nimport {nonAscii} from \"./Utils\";\nimport React, {useState} from \"react\";\nimport {Campaign} from \"./tok/Campaign\";\nimport {useTranslation} from \"react-i18next\";\nimport {tokTheme} from \"./TokTheme\";\nimport {loadCurrentLang, saveLang} from \"./AppStore\";\nimport {CampaignWizardChanger} from \"./CampaignWizard\";\n\nconst Flags = require('country-flag-icons/react/3x2');\n\nexport function TokHeader({campaign}: {campaign: Campaign}) {\n    const [modalOpen, setModalOpen] = useState<boolean>(false);\n    const { t, i18n } = useTranslation();\n    const myLang = loadCurrentLang();\n    const themeSpec = tokTheme();\n    const campaignName = t(campaign.name);\n    const nonAsciiCharsInName = nonAscii(campaignName);\n\n    function changeLang(lang: string) {\n        i18n.changeLanguage(lang);\n        saveLang(lang);\n    }\n\n    return(\n        <Box className=\"App-header\">\n            <Box style={{float: \"right\"}}>\n                <Flags.GB className={\"IconAction\"} onClick={() => changeLang(\"en\")}\n                          style={{width: \"2em\", opacity: myLang === \"en\" ? \"1.0\" : \"0.4\"}}/>\n                <Flags.ES className={\"IconAction\"} onClick={() => changeLang(\"es\")}\n                          style={{width: \"2em\", opacity: myLang === \"es\" ? \"1.0\" : \"0.4\"}}/>\n            </Box>\n            <Typography onClick={() => setModalOpen(true)} style={{\n                cursor: \"pointer\",\n                fontFamily: nonAsciiCharsInName ? themeSpec.headerFontFamilyNonAscii : themeSpec.headerFontFamily,\n                textAlign: \"center\"}} variant=\"h2\" color=\"secondary\" variantMapping={{h1: \"header\"}} className=\"App-header\">\n                {campaignName}\n                <IconButton color=\"secondary\" className=\"IconAction material-icons\" style={{textAlign: \"center\"}} onClick={() => setModalOpen(true)}>edit</IconButton>\n            </Typography>\n            <Modal open={modalOpen} onClose={() => setModalOpen(false)} aria-labelledby=\"campaign-creatuib-title\" style={{overflowY: \"auto\"}}>\n                <CampaignWizardChanger close={() => setModalOpen(false)}/>\n            </Modal>\n        </Box>\n    )\n}\n\n","import React from 'react';\nimport './App.css';\nimport {CurrentScenarioPassZone} from \"./tok/ScenarioPassZone\";\nimport {Box, Button, Container, CssBaseline} from \"@material-ui/core\";\nimport {ThemeProvider} from \"@material-ui/core/styles\";\nimport {tokTheme} from \"./TokTheme\";\nimport {connect} from \"react-redux\";\nimport {changeScenario as changeScenarioAction} from \"./AppActions\";\nimport {IScenarioSpec} from \"./tok/Scenario\";\nimport {useTranslation} from \"react-i18next\";\nimport {AppState} from \"./AppState\";\nimport {Campaign} from \"./tok/Campaign\";\nimport {TokHeader} from \"./TokHeader\";\n\nconst App = connect(\n    (store: AppState) => ({\n        campaign: store.selectedCampaign\n}),\n    (dispatch => ({\n        changeScenario: (scenario:IScenarioSpec) => dispatch(changeScenarioAction(scenario)),\n    }))\n)(AppComponent);\n\nfunction AppComponent({campaign, changeScenario}: {campaign: Campaign,\n                        changeScenario: (scenario: IScenarioSpec) => void}) {\n    const { t } = useTranslation();\n    return (\n    <ThemeProvider theme={tokTheme().theme}>\n        <CssBaseline>\n            <div className=\"App\">\n                <TokHeader campaign={campaign} />\n                <Container className=\"MainContainer\" maxWidth=\"lg\">\n                    <Box textAlign={\"center\"}>\n                        <Button color=\"secondary\"\n                                onClick={() => changeScenario(campaign.prevScenario())}>{t('prev')}</Button>\n                        <Button color=\"secondary\"\n                                onClick={() => changeScenario(campaign.nextScenario())}>{t('next')}</Button>\n                    </Box>\n                    <CurrentScenarioPassZone/>\n                </Container>\n            </div>\n        </CssBaseline>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import i18 from \"i18next\";\nimport {initReactI18next} from \"react-i18next\";\nimport {campaignTranslations} from \"./tok/Campaign\";\n\nexport default function (lang = \"es\") {\n    i18.use(initReactI18next)\n        .init({\n            resources: {\n                es: {\n                    translation: {\n                        ...campaignTranslations[\"es\"],\n                        \"prev\": \"prev.\",\n                        \"next\": \"sig.\",\n                        \"Pass zone\": \"Zona de éxito\",\n                        \"Skill\": \"Habilidad\",\n                        \"Test\": \"Dificultad\",\n                        \"Bag average\": \"Valor medio\",\n                        \"Current character\": \"Personaje actual\",\n                        \"Manage chaos bag\": \"Gestionar bolsa del caos\",\n                        \"Chaos bag\": \"Bolsa del caos\",\n                        \"Current bag\": \"Bolsa actual\",\n                        \"Select tokens to remove them\": \"Selecciona tokens para eliminarlos\",\n                        \"Select tokens to add them to the bag\": \"Selecciona tokens para añadirlos a la bolsa\",\n                        \"Select campaign\": \"Selecciona campaña\",\n                        \"Create campaign\": \"Crear campaña\",\n                        \"Select level\": \"Selecciona nivel\",\n                        \"easy\": \"fácil\", \"normal\": \"normal\", \"hard\": \"difícil\", \"expert\": \"experto\",\n                        \"Pick up two four characters\": \"Elige hasta 4 personajes\",\n                        \"Create\": \"Crear\",\n                        \"Hard and expert coming soon\": \"Difícil y experto próximamente\"\n                    }\n                },\n            },\n            lng: lang,\n            fallbackLng: \"en\"\n        })\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport {loadCurrentLang, store} from \"./AppStore\";\nimport {Provider} from \"react-redux\";\nimport I18n from \"./I18n\";\n\nI18n(loadCurrentLang());\nReactDOM.render(\n  <React.StrictMode>\n      <Provider store={store}>\n        <App />\n      </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}